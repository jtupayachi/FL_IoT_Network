[93mWARNING [0m:   DEPRECATED FEATURE: flwr.server.start_server() is deprecated.
	Instead, use the `flower-superlink` CLI command to start a SuperLink as shown below:

		$ flower-superlink --insecure

	To view usage and all available options, run:

		$ flower-superlink --help

	Using `start_server()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      Starting Flower server, config: num_rounds=10, no round_timeout
[92mINFO [0m:      Flower ECE: gRPC server running (10 rounds), SSL is disabled
[92mINFO [0m:      [INIT]
[92mINFO [0m:      Requesting initial parameters from one random client
[92mINFO [0m:      Received initial parameters from one random client
[92mINFO [0m:      Starting evaluation of initial global parameters
[92mINFO [0m:      initial parameters (loss, other metrics): 0.5058898329734802, {'rmse': 0.7112594246864319, 'mse': 0.5058899521827698, 'mae': 0.5900685787200928, 'r2': -0.0009223222732543945}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 12 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 12 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
[92mINFO [0m:      fit progress: (1, 17.090694427490234, {'rmse': 4.134089469909668, 'mse': 17.090696334838867, 'mae': 4.058290004730225, 'r2': -39.44102096557617}, 43.73090363499978)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[93mWARNING [0m:   No evaluate_metrics_aggregation_fn provided
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (2, 147.31146240234375, {'rmse': 12.13719367980957, 'mse': 147.31146240234375, 'mae': 12.07969856262207, 'r2': -308.2851867675781}, 46.3618139729997)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (3, 151.7901611328125, {'rmse': 12.32031536102295, 'mse': 151.7901611328125, 'mae': 12.253791809082031, 'r2': -289.1011657714844}, 49.05722920900007)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (4, 152.1463623046875, {'rmse': 12.334762573242188, 'mse': 152.14637756347656, 'mae': 12.268268585205078, 'r2': -265.8066711425781}, 51.629934429999594)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (5, 154.15235900878906, {'rmse': 12.415810585021973, 'mse': 154.15234375, 'mae': 12.351750373840332, 'r2': -333.70355224609375}, 56.55418176500007)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (6, 162.602783203125, {'rmse': 12.751579284667969, 'mse': 162.602783203125, 'mae': 12.689125061035156, 'r2': -324.00848388671875}, 59.08197793299951)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (7, 162.56370544433594, {'rmse': 12.75004768371582, 'mse': 162.56370544433594, 'mae': 12.694873809814453, 'r2': -361.9588317871094}, 61.618556171999444)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (8, 171.69651794433594, {'rmse': 13.103302001953125, 'mse': 171.69651794433594, 'mae': 13.038068771362305, 'r2': -332.3465576171875}, 64.1690694279996)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (9, 182.31312561035156, {'rmse': 13.502338409423828, 'mse': 182.31314086914062, 'mae': 13.438797950744629, 'r2': -329.2180480957031}, 69.13952031899953)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (10, 190.65248107910156, {'rmse': 13.807696342468262, 'mse': 190.6524658203125, 'mae': 13.752431869506836, 'r2': -399.8943786621094}, 74.17381545399985)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [SUMMARY]
[92mINFO [0m:      Run finished 10 round(s) in 74.51s
[92mINFO [0m:      	History (loss, distributed):
[92mINFO [0m:      		round 1: 13786.597635863403
[92mINFO [0m:      		round 2: 7424.046913295817
[92mINFO [0m:      		round 3: 7432.9377739765405
[92mINFO [0m:      		round 4: 7436.801991644777
[92mINFO [0m:      		round 5: 7421.002374862187
[92mINFO [0m:      		round 6: 7400.905052360268
[92mINFO [0m:      		round 7: 7395.719510271286
[92mINFO [0m:      		round 8: 7382.108259704327
[92mINFO [0m:      		round 9: 7393.9402959244235
[92mINFO [0m:      		round 10: 7388.2668527824435
[92mINFO [0m:      	History (loss, centralized):
[92mINFO [0m:      		round 0: 0.5058898329734802
[92mINFO [0m:      		round 1: 17.090694427490234
[92mINFO [0m:      		round 2: 147.31146240234375
[92mINFO [0m:      		round 3: 151.7901611328125
[92mINFO [0m:      		round 4: 152.1463623046875
[92mINFO [0m:      		round 5: 154.15235900878906
[92mINFO [0m:      		round 6: 162.602783203125
[92mINFO [0m:      		round 7: 162.56370544433594
[92mINFO [0m:      		round 8: 171.69651794433594
[92mINFO [0m:      		round 9: 182.31312561035156
[92mINFO [0m:      		round 10: 190.65248107910156
[92mINFO [0m:      	History (metrics, centralized):
[92mINFO [0m:      	{'mae': [(0, 0.5900685787200928),
[92mINFO [0m:      	         (1, 4.058290004730225),
[92mINFO [0m:      	         (2, 12.07969856262207),
[92mINFO [0m:      	         (3, 12.253791809082031),
[92mINFO [0m:      	         (4, 12.268268585205078),
[92mINFO [0m:      	         (5, 12.351750373840332),
[92mINFO [0m:      	         (6, 12.689125061035156),
[92mINFO [0m:      	         (7, 12.694873809814453),
[92mINFO [0m:      	         (8, 13.038068771362305),
[92mINFO [0m:      	         (9, 13.438797950744629),
[92mINFO [0m:      	         (10, 13.752431869506836)],
[92mINFO [0m:      	 'mse': [(0, 0.5058899521827698),
[92mINFO [0m:      	         (1, 17.090696334838867),
[92mINFO [0m:      	         (2, 147.31146240234375),
[92mINFO [0m:      	         (3, 151.7901611328125),
[92mINFO [0m:      	         (4, 152.14637756347656),
[92mINFO [0m:      	         (5, 154.15234375),
[92mINFO [0m:      	         (6, 162.602783203125),
[92mINFO [0m:      	         (7, 162.56370544433594),
[92mINFO [0m:      	         (8, 171.69651794433594),
[92mINFO [0m:      	         (9, 182.31314086914062),
[92mINFO [0m:      	         (10, 190.6524658203125)],
[92mINFO [0m:      	 'r2': [(0, -0.0009223222732543945),
[92mINFO [0m:      	        (1, -39.44102096557617),
[92mINFO [0m:      	        (2, -308.2851867675781),
[92mINFO [0m:      	        (3, -289.1011657714844),
[92mINFO [0m:      	        (4, -265.8066711425781),
[92mINFO [0m:      	        (5, -333.70355224609375),
[92mINFO [0m:      	        (6, -324.00848388671875),
[92mINFO [0m:      	        (7, -361.9588317871094),
[92mINFO [0m:      	        (8, -332.3465576171875),
[92mINFO [0m:      	        (9, -329.2180480957031),
[92mINFO [0m:      	        (10, -399.8943786621094)],
[92mINFO [0m:      	 'rmse': [(0, 0.7112594246864319),
[92mINFO [0m:      	          (1, 4.134089469909668),
[92mINFO [0m:      	          (2, 12.13719367980957),
[92mINFO [0m:      	          (3, 12.32031536102295),
[92mINFO [0m:      	          (4, 12.334762573242188),
[92mINFO [0m:      	          (5, 12.415810585021973),
[92mINFO [0m:      	          (6, 12.751579284667969),
[92mINFO [0m:      	          (7, 12.75004768371582),
[92mINFO [0m:      	          (8, 13.103302001953125),
[92mINFO [0m:      	          (9, 13.502338409423828),
[92mINFO [0m:      	          (10, 13.807696342468262)]}
[92mINFO [0m:      
🚀 Starting NASA Federated Learning Server
==================================================
Experiment ID: nasa_25c_alpha_0.1_fedavg
Algorithm: FEDAVG
Server: localhost:8686
Rounds: 10
📁 Directory structure:
   Results root: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_015800/nasa_25c_alpha_0.1_fedavg
   Experiment: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_015800/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg
   Metrics: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_015800/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/metrics
==================================================
🔍 Server model configuration:
   Input dimension: 5
   Model type: lstm
   Hidden dims: [64, 32]
🔄 Starting FL server on localhost:8686...
📊 Centralized evaluation enabled: True
📈 CSV files will be saved to: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_015800/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/metrics
📁 Config saved to: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_015800/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/config.json
🔍 Running centralized evaluation for round 0...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 0:
   Loss: 0.5059, RMSE: 0.7113, R²: -0.0009
📈 Round 0 Centralized Test Evaluation:
   Loss: 0.5059
   RMSE: 0.7113
   R²: -0.0009
⚠️ Could not update round metrics with centralized results: list index out of range
📊 Round 1 Fit Metrics:
   Clients: 12
   Avg Train Loss: 13804.2987
   Avg Val Loss: 13796.6525
   Avg Val R²: -0.9221
🔍 Running centralized evaluation for round 1...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 1:
   Loss: 17.0907, RMSE: 4.1341, R²: -39.4410
📈 Round 1 Centralized Test Evaluation:
   Loss: 17.0907
   RMSE: 4.1341
   R²: -39.4410
📊 Round 2 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7166.2037
   Avg Val Loss: 7181.6552
   Avg Val R²: -0.0159
🔍 Running centralized evaluation for round 2...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 2:
   Loss: 147.3115, RMSE: 12.1372, R²: -308.2852
📈 Round 2 Centralized Test Evaluation:
   Loss: 147.3115
   RMSE: 12.1372
   R²: -308.2852
📊 Round 3 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7178.0190
   Avg Val Loss: 7196.3212
   Avg Val R²: -0.0177
🔍 Running centralized evaluation for round 3...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 3:
   Loss: 151.7902, RMSE: 12.3203, R²: -289.1012
📈 Round 3 Centralized Test Evaluation:
   Loss: 151.7902
   RMSE: 12.3203
   R²: -289.1012
📊 Round 4 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7170.1330
   Avg Val Loss: 7188.2559
   Avg Val R²: -0.0167
🔍 Running centralized evaluation for round 4...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 4:
   Loss: 152.1464, RMSE: 12.3348, R²: -265.8067
📈 Round 4 Centralized Test Evaluation:
   Loss: 152.1464
   RMSE: 12.3348
   R²: -265.8067
📊 Round 5 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7164.4623
   Avg Val Loss: 7181.7719
   Avg Val R²: -0.0156
🔍 Running centralized evaluation for round 5...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 5:
   Loss: 154.1524, RMSE: 12.4158, R²: -333.7036
📈 Round 5 Centralized Test Evaluation:
   Loss: 154.1524
   RMSE: 12.4158
   R²: -333.7036
📊 Round 6 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7146.9424
   Avg Val Loss: 7163.3285
   Avg Val R²: -0.0132
🔍 Running centralized evaluation for round 6...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 6:
   Loss: 162.6028, RMSE: 12.7516, R²: -324.0085
📈 Round 6 Centralized Test Evaluation:
   Loss: 162.6028
   RMSE: 12.7516
   R²: -324.0085
📊 Round 7 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7154.1483
   Avg Val Loss: 7169.4336
   Avg Val R²: -0.0136
🔍 Running centralized evaluation for round 7...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 7:
   Loss: 162.5637, RMSE: 12.7500, R²: -361.9588
📈 Round 7 Centralized Test Evaluation:
   Loss: 162.5637
   RMSE: 12.7500
   R²: -361.9588
📊 Round 8 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7139.3134
   Avg Val Loss: 7152.1721
   Avg Val R²: -0.0118
🔍 Running centralized evaluation for round 8...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 8:
   Loss: 171.6965, RMSE: 13.1033, R²: -332.3466
📈 Round 8 Centralized Test Evaluation:
   Loss: 171.6965
   RMSE: 13.1033
   R²: -332.3466
📊 Round 9 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7147.3052
   Avg Val Loss: 7160.9719
   Avg Val R²: -0.0126
🔍 Running centralized evaluation for round 9...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 9:
   Loss: 182.3131, RMSE: 13.5023, R²: -329.2180
📈 Round 9 Centralized Test Evaluation:
   Loss: 182.3131
   RMSE: 13.5023
   R²: -329.2180
📊 Round 10 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7143.2569
   Avg Val Loss: 7158.0374
   Avg Val R²: -0.0122
🔍 Running centralized evaluation for round 10...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 10:
   Loss: 190.6525, RMSE: 13.8077, R²: -399.8944
📈 Round 10 Centralized Test Evaluation:
   Loss: 190.6525
   RMSE: 13.8077
   R²: -399.8944
✅ Server completed successfully!
📊 Results saved to: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_015800/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg

📈 FINAL SUMMARY:
   Round metrics: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_015800/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/metrics/round_metrics.csv
   Client metrics: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_015800/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/metrics/client_metrics.csv
   Test metrics (centralized): /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_015800/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/metrics/test_metrics.csv
✅ round_metrics.csv: 10 records
✅ client_metrics.csv: 237 records
✅ test_metrics.csv: 11 records
