[93mWARNING [0m:   DEPRECATED FEATURE: flwr.server.start_server() is deprecated.
	Instead, use the `flower-superlink` CLI command to start a SuperLink as shown below:

		$ flower-superlink --insecure

	To view usage and all available options, run:

		$ flower-superlink --help

	Using `start_server()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      Starting Flower server, config: num_rounds=10, no round_timeout
[92mINFO [0m:      Flower ECE: gRPC server running (10 rounds), SSL is disabled
[92mINFO [0m:      [INIT]
[92mINFO [0m:      Requesting initial parameters from one random client
[92mINFO [0m:      Received initial parameters from one random client
[92mINFO [0m:      Starting evaluation of initial global parameters
[92mINFO [0m:      initial parameters (loss, other metrics): 0.46569114923477173, {'rmse': 0.6824156641960144, 'mse': 0.46569114923477173, 'mae': 0.5506289601325989, 'r2': -0.009807109832763672}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 12 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 12 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
[92mINFO [0m:      fit progress: (1, 17.59207534790039, {'rmse': 4.194290637969971, 'mse': 17.592073440551758, 'mae': 4.099350452423096, 'r2': -29.03960418701172}, 47.84267026999987)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[93mWARNING [0m:   No evaluate_metrics_aggregation_fn provided
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (2, 119.71607208251953, {'rmse': 10.941483497619629, 'mse': 119.716064453125, 'mae': 10.891465187072754, 'r2': -254.0868377685547}, 50.554638737999994)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (3, 129.41168212890625, {'rmse': 11.37592601776123, 'mse': 129.41168212890625, 'mae': 11.317172050476074, 'r2': -320.2832946777344}, 53.16078214999925)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (4, 126.387451171875, {'rmse': 11.242218971252441, 'mse': 126.38748168945312, 'mae': 11.179431915283203, 'r2': -265.5071105957031}, 55.69755370199982)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (5, 133.2608184814453, {'rmse': 11.543865203857422, 'mse': 133.2608184814453, 'mae': 11.477694511413574, 'r2': -268.5193786621094}, 60.759153043999504)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (6, 135.05419921875, {'rmse': 11.621281623840332, 'mse': 135.05418395996094, 'mae': 11.550670623779297, 'r2': -291.0666809082031}, 63.34182227999918)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (7, 137.50851440429688, {'rmse': 11.726401329040527, 'mse': 137.5084991455078, 'mae': 11.657556533813477, 'r2': -305.6571960449219}, 65.8787913419992)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (8, 142.50430297851562, {'rmse': 11.937517166137695, 'mse': 142.5043182373047, 'mae': 11.878252983093262, 'r2': -329.28411865234375}, 68.46800390199951)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (9, 152.07501220703125, {'rmse': 12.331870079040527, 'mse': 152.07501220703125, 'mae': 12.225635528564453, 'r2': -214.86026000976562}, 73.47365156599972)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (10, 150.7377471923828, {'rmse': 12.2775297164917, 'mse': 150.7377471923828, 'mae': 12.207093238830566, 'r2': -317.7535095214844}, 78.49259556099969)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [SUMMARY]
[92mINFO [0m:      Run finished 10 round(s) in 78.83s
[92mINFO [0m:      	History (loss, distributed):
[92mINFO [0m:      		round 1: 13927.10444492557
[92mINFO [0m:      		round 2: 7472.254847722702
[92mINFO [0m:      		round 3: 7442.656608261085
[92mINFO [0m:      		round 4: 7437.088922080983
[92mINFO [0m:      		round 5: 7426.722596662537
[92mINFO [0m:      		round 6: 7428.877953893708
[92mINFO [0m:      		round 7: 7445.331073248661
[92mINFO [0m:      		round 8: 7431.931035999019
[92mINFO [0m:      		round 9: 7439.009906313998
[92mINFO [0m:      		round 10: 7435.1240173629385
[92mINFO [0m:      	History (loss, centralized):
[92mINFO [0m:      		round 0: 0.46569114923477173
[92mINFO [0m:      		round 1: 17.59207534790039
[92mINFO [0m:      		round 2: 119.71607208251953
[92mINFO [0m:      		round 3: 129.41168212890625
[92mINFO [0m:      		round 4: 126.387451171875
[92mINFO [0m:      		round 5: 133.2608184814453
[92mINFO [0m:      		round 6: 135.05419921875
[92mINFO [0m:      		round 7: 137.50851440429688
[92mINFO [0m:      		round 8: 142.50430297851562
[92mINFO [0m:      		round 9: 152.07501220703125
[92mINFO [0m:      		round 10: 150.7377471923828
[92mINFO [0m:      	History (metrics, centralized):
[92mINFO [0m:      	{'mae': [(0, 0.5506289601325989),
[92mINFO [0m:      	         (1, 4.099350452423096),
[92mINFO [0m:      	         (2, 10.891465187072754),
[92mINFO [0m:      	         (3, 11.317172050476074),
[92mINFO [0m:      	         (4, 11.179431915283203),
[92mINFO [0m:      	         (5, 11.477694511413574),
[92mINFO [0m:      	         (6, 11.550670623779297),
[92mINFO [0m:      	         (7, 11.657556533813477),
[92mINFO [0m:      	         (8, 11.878252983093262),
[92mINFO [0m:      	         (9, 12.225635528564453),
[92mINFO [0m:      	         (10, 12.207093238830566)],
[92mINFO [0m:      	 'mse': [(0, 0.46569114923477173),
[92mINFO [0m:      	         (1, 17.592073440551758),
[92mINFO [0m:      	         (2, 119.716064453125),
[92mINFO [0m:      	         (3, 129.41168212890625),
[92mINFO [0m:      	         (4, 126.38748168945312),
[92mINFO [0m:      	         (5, 133.2608184814453),
[92mINFO [0m:      	         (6, 135.05418395996094),
[92mINFO [0m:      	         (7, 137.5084991455078),
[92mINFO [0m:      	         (8, 142.5043182373047),
[92mINFO [0m:      	         (9, 152.07501220703125),
[92mINFO [0m:      	         (10, 150.7377471923828)],
[92mINFO [0m:      	 'r2': [(0, -0.009807109832763672),
[92mINFO [0m:      	        (1, -29.03960418701172),
[92mINFO [0m:      	        (2, -254.0868377685547),
[92mINFO [0m:      	        (3, -320.2832946777344),
[92mINFO [0m:      	        (4, -265.5071105957031),
[92mINFO [0m:      	        (5, -268.5193786621094),
[92mINFO [0m:      	        (6, -291.0666809082031),
[92mINFO [0m:      	        (7, -305.6571960449219),
[92mINFO [0m:      	        (8, -329.28411865234375),
[92mINFO [0m:      	        (9, -214.86026000976562),
[92mINFO [0m:      	        (10, -317.7535095214844)],
[92mINFO [0m:      	 'rmse': [(0, 0.6824156641960144),
[92mINFO [0m:      	          (1, 4.194290637969971),
[92mINFO [0m:      	          (2, 10.941483497619629),
[92mINFO [0m:      	          (3, 11.37592601776123),
[92mINFO [0m:      	          (4, 11.242218971252441),
[92mINFO [0m:      	          (5, 11.543865203857422),
[92mINFO [0m:      	          (6, 11.621281623840332),
[92mINFO [0m:      	          (7, 11.726401329040527),
[92mINFO [0m:      	          (8, 11.937517166137695),
[92mINFO [0m:      	          (9, 12.331870079040527),
[92mINFO [0m:      	          (10, 12.2775297164917)]}
[92mINFO [0m:      
🚀 Starting NASA Federated Learning Server
==================================================
Experiment ID: nasa_25c_alpha_0.1_fedavg
Algorithm: FEDAVG
Server: localhost:8686
Rounds: 10
📁 Directory structure:
   Results root: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_020137/nasa_25c_alpha_0.1_fedavg
   Experiment: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_020137/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg
   Metrics: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_020137/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/metrics
==================================================
🔍 Server model configuration:
   Input dimension: 5
   Model type: lstm
   Hidden dims: [64, 32]
🔄 Starting FL server on localhost:8686...
📊 Centralized evaluation enabled: True
📈 CSV files will be saved to: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_020137/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/metrics
📁 Config saved to: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_020137/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/config.json
🔍 Running centralized evaluation for round 0...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 0:
   Loss: 0.4657, RMSE: 0.6824, R²: -0.0098
📈 Round 0 Centralized Test Evaluation:
   Loss: 0.4657
   RMSE: 0.6824
   R²: -0.0098
⚠️ Could not update round metrics with centralized results: list index out of range
📊 Round 1 Fit Metrics:
   Clients: 12
   Avg Train Loss: 12462.1861
   Avg Val Loss: 12176.1054
   Avg Val R²: -0.8456
🔍 Running centralized evaluation for round 1...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 1:
   Loss: 17.5921, RMSE: 4.1943, R²: -29.0396
📈 Round 1 Centralized Test Evaluation:
   Loss: 17.5921
   RMSE: 4.1943
   R²: -29.0396
📊 Round 2 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7216.4628
   Avg Val Loss: 7238.6917
   Avg Val R²: -0.0231
🔍 Running centralized evaluation for round 2...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 2:
   Loss: 119.7161, RMSE: 10.9415, R²: -254.0868
📈 Round 2 Centralized Test Evaluation:
   Loss: 119.7161
   RMSE: 10.9415
   R²: -254.0868
📊 Round 3 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7184.3124
   Avg Val Loss: 7201.4828
   Avg Val R²: -0.0184
🔍 Running centralized evaluation for round 3...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 3:
   Loss: 129.4117, RMSE: 11.3759, R²: -320.2833
📈 Round 3 Centralized Test Evaluation:
   Loss: 129.4117
   RMSE: 11.3759
   R²: -320.2833
📊 Round 4 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7179.4937
   Avg Val Loss: 7196.3215
   Avg Val R²: -0.0176
🔍 Running centralized evaluation for round 4...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 4:
   Loss: 126.3875, RMSE: 11.2422, R²: -265.5071
📈 Round 4 Centralized Test Evaluation:
   Loss: 126.3875
   RMSE: 11.2422
   R²: -265.5071
📊 Round 5 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7174.8480
   Avg Val Loss: 7193.5120
   Avg Val R²: -0.0171
🔍 Running centralized evaluation for round 5...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 5:
   Loss: 133.2608, RMSE: 11.5439, R²: -268.5194
📈 Round 5 Centralized Test Evaluation:
   Loss: 133.2608
   RMSE: 11.5439
   R²: -268.5194
📊 Round 6 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7176.6754
   Avg Val Loss: 7195.6203
   Avg Val R²: -0.0176
🔍 Running centralized evaluation for round 6...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 6:
   Loss: 135.0542, RMSE: 11.6213, R²: -291.0667
📈 Round 6 Centralized Test Evaluation:
   Loss: 135.0542
   RMSE: 11.6213
   R²: -291.0667
📊 Round 7 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7189.6219
   Avg Val Loss: 7207.1554
   Avg Val R²: -0.0190
🔍 Running centralized evaluation for round 7...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 7:
   Loss: 137.5085, RMSE: 11.7264, R²: -305.6572
📈 Round 7 Centralized Test Evaluation:
   Loss: 137.5085
   RMSE: 11.7264
   R²: -305.6572
📊 Round 8 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7179.5597
   Avg Val Loss: 7196.3258
   Avg Val R²: -0.0177
🔍 Running centralized evaluation for round 8...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 8:
   Loss: 142.5043, RMSE: 11.9375, R²: -329.2841
📈 Round 8 Centralized Test Evaluation:
   Loss: 142.5043
   RMSE: 11.9375
   R²: -329.2841
📊 Round 9 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7184.1542
   Avg Val Loss: 7202.2730
   Avg Val R²: -0.0184
🔍 Running centralized evaluation for round 9...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 9:
   Loss: 152.0750, RMSE: 12.3319, R²: -214.8603
📈 Round 9 Centralized Test Evaluation:
   Loss: 152.0750
   RMSE: 12.3319
   R²: -214.8603
📊 Round 10 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7181.9025
   Avg Val Loss: 7200.1187
   Avg Val R²: -0.0182
🔍 Running centralized evaluation for round 10...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 10:
   Loss: 150.7377, RMSE: 12.2775, R²: -317.7535
📈 Round 10 Centralized Test Evaluation:
   Loss: 150.7377
   RMSE: 12.2775
   R²: -317.7535
✅ Server completed successfully!
📊 Results saved to: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_020137/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg

📈 FINAL SUMMARY:
   Round metrics: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_020137/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/metrics/round_metrics.csv
   Client metrics: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_020137/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/metrics/client_metrics.csv
   Test metrics (centralized): /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_020137/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/metrics/test_metrics.csv
✅ round_metrics.csv: 10 records
✅ client_metrics.csv: 237 records
✅ test_metrics.csv: 11 records
