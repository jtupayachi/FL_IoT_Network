[93mWARNING [0m:   DEPRECATED FEATURE: flwr.server.start_server() is deprecated.
	Instead, use the `flower-superlink` CLI command to start a SuperLink as shown below:

		$ flower-superlink --insecure

	To view usage and all available options, run:

		$ flower-superlink --help

	Using `start_server()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      Starting Flower server, config: num_rounds=10, no round_timeout
[92mINFO [0m:      Flower ECE: gRPC server running (10 rounds), SSL is disabled
[92mINFO [0m:      [INIT]
[92mINFO [0m:      Requesting initial parameters from one random client
[92mINFO [0m:      Received initial parameters from one random client
[92mINFO [0m:      Starting evaluation of initial global parameters
[92mINFO [0m:      initial parameters (loss, other metrics): 0.4986318349838257, {'rmse': 0.7061386704444885, 'mse': 0.4986318349838257, 'mae': 0.543449878692627, 'r2': -0.05012774467468262}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 12 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 12 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
[92mINFO [0m:      fit progress: (1, 31.777708053588867, {'rmse': 5.637172222137451, 'mse': 31.777708053588867, 'mae': 5.51982307434082, 'r2': -68.97251892089844}, 42.879045132998726)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[93mWARNING [0m:   No evaluate_metrics_aggregation_fn provided
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (2, 144.24453735351562, {'rmse': 12.010184288024902, 'mse': 144.24453735351562, 'mae': 11.884267807006836, 'r2': -396.7723693847656}, 45.55685870599882)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (3, 153.4527130126953, {'rmse': 12.387602806091309, 'mse': 153.45269775390625, 'mae': 12.283394813537598, 'r2': -335.9420471191406}, 48.136574858999666)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (4, 156.6680145263672, {'rmse': 12.516709327697754, 'mse': 156.6680145263672, 'mae': 12.381165504455566, 'r2': -265.2430114746094}, 50.67630373099928)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (5, 165.52642822265625, {'rmse': 12.865708351135254, 'mse': 165.5264434814453, 'mae': 12.741585731506348, 'r2': -315.0587463378906}, 55.73425880799914)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (6, 172.67601013183594, {'rmse': 13.140624046325684, 'mse': 172.67601013183594, 'mae': 12.997408866882324, 'r2': -284.3971252441406}, 58.247567092999816)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (7, 183.10308837890625, {'rmse': 13.5315580368042, 'mse': 183.1030731201172, 'mae': 13.399161338806152, 'r2': -366.9101257324219}, 60.73687822299871)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (8, 183.09988403320312, {'rmse': 13.531440734863281, 'mse': 183.09988403320312, 'mae': 13.396646499633789, 'r2': -383.7403259277344}, 63.31213158799983)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (9, 200.2855682373047, {'rmse': 14.152228355407715, 'mse': 200.2855682373047, 'mae': 14.047728538513184, 'r2': -442.5218200683594}, 68.39285005099919)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (10, 200.2644500732422, {'rmse': 14.151481628417969, 'mse': 200.26443481445312, 'mae': 14.051858901977539, 'r2': -408.5595703125}, 73.43102795899904)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [SUMMARY]
[92mINFO [0m:      Run finished 10 round(s) in 73.76s
[92mINFO [0m:      	History (loss, distributed):
[92mINFO [0m:      		round 1: 11248.922033444818
[92mINFO [0m:      		round 2: 7415.016991438918
[92mINFO [0m:      		round 3: 7418.153600056807
[92mINFO [0m:      		round 4: 7402.6769853017695
[92mINFO [0m:      		round 5: 7412.08363583935
[92mINFO [0m:      		round 6: 7396.541592002735
[92mINFO [0m:      		round 7: 7401.261466793746
[92mINFO [0m:      		round 8: 7385.6274701377
[92mINFO [0m:      		round 9: 7404.6514689977685
[92mINFO [0m:      		round 10: 7391.196775088799
[92mINFO [0m:      	History (loss, centralized):
[92mINFO [0m:      		round 0: 0.4986318349838257
[92mINFO [0m:      		round 1: 31.777708053588867
[92mINFO [0m:      		round 2: 144.24453735351562
[92mINFO [0m:      		round 3: 153.4527130126953
[92mINFO [0m:      		round 4: 156.6680145263672
[92mINFO [0m:      		round 5: 165.52642822265625
[92mINFO [0m:      		round 6: 172.67601013183594
[92mINFO [0m:      		round 7: 183.10308837890625
[92mINFO [0m:      		round 8: 183.09988403320312
[92mINFO [0m:      		round 9: 200.2855682373047
[92mINFO [0m:      		round 10: 200.2644500732422
[92mINFO [0m:      	History (metrics, centralized):
[92mINFO [0m:      	{'mae': [(0, 0.543449878692627),
[92mINFO [0m:      	         (1, 5.51982307434082),
[92mINFO [0m:      	         (2, 11.884267807006836),
[92mINFO [0m:      	         (3, 12.283394813537598),
[92mINFO [0m:      	         (4, 12.381165504455566),
[92mINFO [0m:      	         (5, 12.741585731506348),
[92mINFO [0m:      	         (6, 12.997408866882324),
[92mINFO [0m:      	         (7, 13.399161338806152),
[92mINFO [0m:      	         (8, 13.396646499633789),
[92mINFO [0m:      	         (9, 14.047728538513184),
[92mINFO [0m:      	         (10, 14.051858901977539)],
[92mINFO [0m:      	 'mse': [(0, 0.4986318349838257),
[92mINFO [0m:      	         (1, 31.777708053588867),
[92mINFO [0m:      	         (2, 144.24453735351562),
[92mINFO [0m:      	         (3, 153.45269775390625),
[92mINFO [0m:      	         (4, 156.6680145263672),
[92mINFO [0m:      	         (5, 165.5264434814453),
[92mINFO [0m:      	         (6, 172.67601013183594),
[92mINFO [0m:      	         (7, 183.1030731201172),
[92mINFO [0m:      	         (8, 183.09988403320312),
[92mINFO [0m:      	         (9, 200.2855682373047),
[92mINFO [0m:      	         (10, 200.26443481445312)],
[92mINFO [0m:      	 'r2': [(0, -0.05012774467468262),
[92mINFO [0m:      	        (1, -68.97251892089844),
[92mINFO [0m:      	        (2, -396.7723693847656),
[92mINFO [0m:      	        (3, -335.9420471191406),
[92mINFO [0m:      	        (4, -265.2430114746094),
[92mINFO [0m:      	        (5, -315.0587463378906),
[92mINFO [0m:      	        (6, -284.3971252441406),
[92mINFO [0m:      	        (7, -366.9101257324219),
[92mINFO [0m:      	        (8, -383.7403259277344),
[92mINFO [0m:      	        (9, -442.5218200683594),
[92mINFO [0m:      	        (10, -408.5595703125)],
[92mINFO [0m:      	 'rmse': [(0, 0.7061386704444885),
[92mINFO [0m:      	          (1, 5.637172222137451),
[92mINFO [0m:      	          (2, 12.010184288024902),
[92mINFO [0m:      	          (3, 12.387602806091309),
[92mINFO [0m:      	          (4, 12.516709327697754),
[92mINFO [0m:      	          (5, 12.865708351135254),
[92mINFO [0m:      	          (6, 13.140624046325684),
[92mINFO [0m:      	          (7, 13.5315580368042),
[92mINFO [0m:      	          (8, 13.531440734863281),
[92mINFO [0m:      	          (9, 14.152228355407715),
[92mINFO [0m:      	          (10, 14.151481628417969)]}
[92mINFO [0m:      
🚀 Starting NASA Federated Learning Server
==================================================
Experiment ID: nasa_25c_alpha_0.1_fedavg
Algorithm: FEDAVG
Server: localhost:8686
Rounds: 10
📁 Directory structure:
   Results root: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_022418/nasa_25c_alpha_0.1_fedavg
   Experiment: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_022418/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg
   Metrics: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_022418/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/metrics
==================================================
🔍 Server model configuration:
   Input dimension: 5
   Model type: lstm
   Hidden dims: [64, 32]
🔄 Starting FL server on localhost:8686...
📊 Centralized evaluation enabled: True
📈 CSV files will be saved to: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_022418/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/metrics
📁 Config saved to: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_022418/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/config.json
🔍 Running centralized evaluation for round 0...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 0:
   Loss: 0.4986, RMSE: 0.7061, R²: -0.0501
📈 Round 0 Centralized Test Evaluation:
   Loss: 0.4986
   RMSE: 0.7061
   R²: -0.0501
⚠️ Could not update round metrics with centralized results: list index out of range
📊 Round 1 Fit Metrics:
   Clients: 12
   Avg Train Loss: 9574.1673
   Avg Val Loss: 9331.4951
   Avg Val R²: -0.4665
🔍 Running centralized evaluation for round 1...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 1:
   Loss: 31.7777, RMSE: 5.6372, R²: -68.9725
📈 Round 1 Centralized Test Evaluation:
   Loss: 31.7777
   RMSE: 5.6372
   R²: -68.9725
📊 Round 2 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7157.7757
   Avg Val Loss: 7177.6949
   Avg Val R²: -0.0151
🔍 Running centralized evaluation for round 2...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 2:
   Loss: 144.2445, RMSE: 12.0102, R²: -396.7724
📈 Round 2 Centralized Test Evaluation:
   Loss: 144.2445
   RMSE: 12.0102
   R²: -396.7724
📊 Round 3 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7165.2011
   Avg Val Loss: 7180.8816
   Avg Val R²: -0.0156
🔍 Running centralized evaluation for round 3...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 3:
   Loss: 153.4527, RMSE: 12.3876, R²: -335.9420
📈 Round 3 Centralized Test Evaluation:
   Loss: 153.4527
   RMSE: 12.3876
   R²: -335.9420
📊 Round 4 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7154.2831
   Avg Val Loss: 7170.7869
   Avg Val R²: -0.0141
🔍 Running centralized evaluation for round 4...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 4:
   Loss: 156.6680, RMSE: 12.5167, R²: -265.2430
📈 Round 4 Centralized Test Evaluation:
   Loss: 156.6680
   RMSE: 12.5167
   R²: -265.2430
📊 Round 5 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7157.1428
   Avg Val Loss: 7169.9460
   Avg Val R²: -0.0141
🔍 Running centralized evaluation for round 5...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 5:
   Loss: 165.5264, RMSE: 12.8657, R²: -315.0587
📈 Round 5 Centralized Test Evaluation:
   Loss: 165.5264
   RMSE: 12.8657
   R²: -315.0587
📊 Round 6 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7146.1853
   Avg Val Loss: 7160.1784
   Avg Val R²: -0.0128
🔍 Running centralized evaluation for round 6...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 6:
   Loss: 172.6760, RMSE: 13.1406, R²: -284.3971
📈 Round 6 Centralized Test Evaluation:
   Loss: 172.6760
   RMSE: 13.1406
   R²: -284.3971
📊 Round 7 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7153.7870
   Avg Val Loss: 7171.9418
   Avg Val R²: -0.0143
🔍 Running centralized evaluation for round 7...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 7:
   Loss: 183.1031, RMSE: 13.5316, R²: -366.9101
📈 Round 7 Centralized Test Evaluation:
   Loss: 183.1031
   RMSE: 13.5316
   R²: -366.9101
📊 Round 8 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7142.2285
   Avg Val Loss: 7157.8224
   Avg Val R²: -0.0126
🔍 Running centralized evaluation for round 8...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 8:
   Loss: 183.0999, RMSE: 13.5314, R²: -383.7403
📈 Round 8 Centralized Test Evaluation:
   Loss: 183.0999
   RMSE: 13.5314
   R²: -383.7403
📊 Round 9 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7150.6894
   Avg Val Loss: 7165.3220
   Avg Val R²: -0.0134
🔍 Running centralized evaluation for round 9...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 9:
   Loss: 200.2856, RMSE: 14.1522, R²: -442.5218
📈 Round 9 Centralized Test Evaluation:
   Loss: 200.2856
   RMSE: 14.1522
   R²: -442.5218
📊 Round 10 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7146.1224
   Avg Val Loss: 7157.3675
   Avg Val R²: -0.0124
🔍 Running centralized evaluation for round 10...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 10:
   Loss: 200.2645, RMSE: 14.1515, R²: -408.5596
📈 Round 10 Centralized Test Evaluation:
   Loss: 200.2645
   RMSE: 14.1515
   R²: -408.5596
✅ Server completed successfully!
📊 Results saved to: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_022418/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg

📈 FINAL SUMMARY:
   Round metrics: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_022418/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/metrics/round_metrics.csv
   Client metrics: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_022418/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/metrics/client_metrics.csv
   Test metrics (centralized): /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_022418/nasa_25c_alpha_0.1_fedavg/nasa_25c_alpha_0.1_fedavg/metrics/test_metrics.csv
✅ round_metrics.csv: 10 records
✅ client_metrics.csv: 237 records
✅ test_metrics.csv: 11 records
