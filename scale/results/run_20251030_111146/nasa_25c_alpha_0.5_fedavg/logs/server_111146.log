[93mWARNING [0m:   DEPRECATED FEATURE: flwr.server.start_server() is deprecated.
	Instead, use the `flower-superlink` CLI command to start a SuperLink as shown below:

		$ flower-superlink --insecure

	To view usage and all available options, run:

		$ flower-superlink --help

	Using `start_server()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      Starting Flower server, config: num_rounds=10, no round_timeout
[92mINFO [0m:      Flower ECE: gRPC server running (10 rounds), SSL is disabled
[92mINFO [0m:      [INIT]
[92mINFO [0m:      Requesting initial parameters from one random client
[92mINFO [0m:      Received initial parameters from one random client
[92mINFO [0m:      Starting evaluation of initial global parameters
[92mINFO [0m:      initial parameters (loss, other metrics): 0.6907903552055359, {'rmse': 0.831138014793396, 'mse': 0.6907903552055359, 'mae': 0.6610828638076782, 'r2': -0.30858516693115234}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 12 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 12 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
[92mINFO [0m:      fit progress: (1, 25.10284996032715, {'rmse': 5.010274410247803, 'mse': 25.10285186767578, 'mae': 4.936437129974365, 'r2': -55.70716094970703}, 16.886420116999943)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[93mWARNING [0m:   No evaluate_metrics_aggregation_fn provided
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (2, 133.00633239746094, {'rmse': 11.5328369140625, 'mse': 133.00631713867188, 'mae': 11.471484184265137, 'r2': -271.6929626464844}, 19.650392216004548)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (3, 133.33494567871094, {'rmse': 11.547076225280762, 'mse': 133.3349609375, 'mae': 11.502264022827148, 'r2': -297.49578857421875}, 22.25702128300327)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (4, 143.29832458496094, {'rmse': 11.970728874206543, 'mse': 143.29833984375, 'mae': 11.928021430969238, 'r2': -336.95623779296875}, 24.77580887899967)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (5, 143.3289794921875, {'rmse': 11.972006797790527, 'mse': 143.32894897460938, 'mae': 11.93400764465332, 'r2': -311.8757629394531}, 29.73449557400454)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (6, 149.1649932861328, {'rmse': 12.213313102722168, 'mse': 149.16500854492188, 'mae': 12.182391166687012, 'r2': -340.1670837402344}, 32.30969293999806)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (7, 149.96157836914062, {'rmse': 12.245880126953125, 'mse': 149.96157836914062, 'mae': 12.217485427856445, 'r2': -397.6934814453125}, 34.874223368002276)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (8, 155.0340576171875, {'rmse': 12.45126724243164, 'mse': 155.0340576171875, 'mae': 12.415779113769531, 'r2': -268.68853759765625}, 37.40443910899921)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (9, 159.82778930664062, {'rmse': 12.642300605773926, 'mse': 159.82777404785156, 'mae': 12.608850479125977, 'r2': -316.2153015136719}, 42.46760098400409)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (10, 165.27188110351562, {'rmse': 12.85581111907959, 'mse': 165.27188110351562, 'mae': 12.826530456542969, 'r2': -309.8204040527344}, 47.524674460000824)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [SUMMARY]
[92mINFO [0m:      Run finished 10 round(s) in 47.86s
[92mINFO [0m:      	History (loss, distributed):
[92mINFO [0m:      		round 1: 11122.225448516845
[92mINFO [0m:      		round 2: 7233.2275716115155
[92mINFO [0m:      		round 3: 7225.251898917544
[92mINFO [0m:      		round 4: 7209.31616401906
[92mINFO [0m:      		round 5: 7215.811843881178
[92mINFO [0m:      		round 6: 7207.36623894622
[92mINFO [0m:      		round 7: 7221.364523772623
[92mINFO [0m:      		round 8: 7219.91527891592
[92mINFO [0m:      		round 9: 7213.672139104124
[92mINFO [0m:      		round 10: 7205.806895387771
[92mINFO [0m:      	History (loss, centralized):
[92mINFO [0m:      		round 0: 0.6907903552055359
[92mINFO [0m:      		round 1: 25.10284996032715
[92mINFO [0m:      		round 2: 133.00633239746094
[92mINFO [0m:      		round 3: 133.33494567871094
[92mINFO [0m:      		round 4: 143.29832458496094
[92mINFO [0m:      		round 5: 143.3289794921875
[92mINFO [0m:      		round 6: 149.1649932861328
[92mINFO [0m:      		round 7: 149.96157836914062
[92mINFO [0m:      		round 8: 155.0340576171875
[92mINFO [0m:      		round 9: 159.82778930664062
[92mINFO [0m:      		round 10: 165.27188110351562
[92mINFO [0m:      	History (metrics, centralized):
[92mINFO [0m:      	{'mae': [(0, 0.6610828638076782),
[92mINFO [0m:      	         (1, 4.936437129974365),
[92mINFO [0m:      	         (2, 11.471484184265137),
[92mINFO [0m:      	         (3, 11.502264022827148),
[92mINFO [0m:      	         (4, 11.928021430969238),
[92mINFO [0m:      	         (5, 11.93400764465332),
[92mINFO [0m:      	         (6, 12.182391166687012),
[92mINFO [0m:      	         (7, 12.217485427856445),
[92mINFO [0m:      	         (8, 12.415779113769531),
[92mINFO [0m:      	         (9, 12.608850479125977),
[92mINFO [0m:      	         (10, 12.826530456542969)],
[92mINFO [0m:      	 'mse': [(0, 0.6907903552055359),
[92mINFO [0m:      	         (1, 25.10285186767578),
[92mINFO [0m:      	         (2, 133.00631713867188),
[92mINFO [0m:      	         (3, 133.3349609375),
[92mINFO [0m:      	         (4, 143.29833984375),
[92mINFO [0m:      	         (5, 143.32894897460938),
[92mINFO [0m:      	         (6, 149.16500854492188),
[92mINFO [0m:      	         (7, 149.96157836914062),
[92mINFO [0m:      	         (8, 155.0340576171875),
[92mINFO [0m:      	         (9, 159.82777404785156),
[92mINFO [0m:      	         (10, 165.27188110351562)],
[92mINFO [0m:      	 'r2': [(0, -0.30858516693115234),
[92mINFO [0m:      	        (1, -55.70716094970703),
[92mINFO [0m:      	        (2, -271.6929626464844),
[92mINFO [0m:      	        (3, -297.49578857421875),
[92mINFO [0m:      	        (4, -336.95623779296875),
[92mINFO [0m:      	        (5, -311.8757629394531),
[92mINFO [0m:      	        (6, -340.1670837402344),
[92mINFO [0m:      	        (7, -397.6934814453125),
[92mINFO [0m:      	        (8, -268.68853759765625),
[92mINFO [0m:      	        (9, -316.2153015136719),
[92mINFO [0m:      	        (10, -309.8204040527344)],
[92mINFO [0m:      	 'rmse': [(0, 0.831138014793396),
[92mINFO [0m:      	          (1, 5.010274410247803),
[92mINFO [0m:      	          (2, 11.5328369140625),
[92mINFO [0m:      	          (3, 11.547076225280762),
[92mINFO [0m:      	          (4, 11.970728874206543),
[92mINFO [0m:      	          (5, 11.972006797790527),
[92mINFO [0m:      	          (6, 12.213313102722168),
[92mINFO [0m:      	          (7, 12.245880126953125),
[92mINFO [0m:      	          (8, 12.45126724243164),
[92mINFO [0m:      	          (9, 12.642300605773926),
[92mINFO [0m:      	          (10, 12.85581111907959)]}
[92mINFO [0m:      
🚀 Starting NASA Federated Learning Server
==================================================
Experiment ID: nasa_25c_alpha_0.5_fedavg
Algorithm: FEDAVG
Strategy: FEDAVG
Server: localhost:8686
Rounds: 10

📁 Directory structure:
   Results: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_111146/nasa_25c_alpha_0.5_fedavg/nasa_25c_alpha_0.5_fedavg
   Metrics: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_111146/nasa_25c_alpha_0.5_fedavg/nasa_25c_alpha_0.5_fedavg/metrics
==================================================

⚙️ Creating FEDAVG strategy...

🎯 Starting federated learning...

🔍 Running centralized evaluation for round 0...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 0:
   Loss: 0.6908, RMSE: 0.8311, R²: -0.3086
📈 Round 0 Centralized Test Evaluation:
   Loss: 0.6908
   RMSE: 0.8311
   R²: -0.3086
⚠️ Could not update round metrics: list index out of range
📊 Round 1 Fit Metrics:
   Clients: 12
   Avg Train Loss: 11940.3408
   Avg Val Loss: 11651.7701
   Avg Val R²: -0.6043
🔍 Running centralized evaluation for round 1...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 1:
   Loss: 25.1028, RMSE: 5.0103, R²: -55.7072
📈 Round 1 Centralized Test Evaluation:
   Loss: 25.1028
   RMSE: 5.0103
   R²: -55.7072
📊 Round 2 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7120.9993
   Avg Val Loss: 7053.1090
   Avg Val R²: -0.0211
🔍 Running centralized evaluation for round 2...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 2:
   Loss: 133.0063, RMSE: 11.5328, R²: -271.6930
📈 Round 2 Centralized Test Evaluation:
   Loss: 133.0063
   RMSE: 11.5328
   R²: -271.6930
📊 Round 3 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7118.9259
   Avg Val Loss: 7047.7674
   Avg Val R²: -0.0200
🔍 Running centralized evaluation for round 3...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 3:
   Loss: 133.3349, RMSE: 11.5471, R²: -297.4958
📈 Round 3 Centralized Test Evaluation:
   Loss: 133.3349
   RMSE: 11.5471
   R²: -297.4958
📊 Round 4 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7104.4093
   Avg Val Loss: 7029.2984
   Avg Val R²: -0.0175
🔍 Running centralized evaluation for round 4...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 4:
   Loss: 143.2983, RMSE: 11.9707, R²: -336.9562
📈 Round 4 Centralized Test Evaluation:
   Loss: 143.2983
   RMSE: 11.9707
   R²: -336.9562
📊 Round 5 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7108.3068
   Avg Val Loss: 7039.4526
   Avg Val R²: -0.0189
🔍 Running centralized evaluation for round 5...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 5:
   Loss: 143.3290, RMSE: 11.9720, R²: -311.8758
📈 Round 5 Centralized Test Evaluation:
   Loss: 143.3290
   RMSE: 11.9720
   R²: -311.8758
📊 Round 6 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7101.8725
   Avg Val Loss: 7029.2058
   Avg Val R²: -0.0175
🔍 Running centralized evaluation for round 6...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 6:
   Loss: 149.1650, RMSE: 12.2133, R²: -340.1671
📈 Round 6 Centralized Test Evaluation:
   Loss: 149.1650
   RMSE: 12.2133
   R²: -340.1671
📊 Round 7 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7116.1153
   Avg Val Loss: 7043.5385
   Avg Val R²: -0.0195
🔍 Running centralized evaluation for round 7...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 7:
   Loss: 149.9616, RMSE: 12.2459, R²: -397.6935
📈 Round 7 Centralized Test Evaluation:
   Loss: 149.9616
   RMSE: 12.2459
   R²: -397.6935
📊 Round 8 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7113.1587
   Avg Val Loss: 7042.6255
   Avg Val R²: -0.0194
🔍 Running centralized evaluation for round 8...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 8:
   Loss: 155.0341, RMSE: 12.4513, R²: -268.6885
📈 Round 8 Centralized Test Evaluation:
   Loss: 155.0341
   RMSE: 12.4513
   R²: -268.6885
📊 Round 9 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7107.5118
   Avg Val Loss: 7038.2301
   Avg Val R²: -0.0188
🔍 Running centralized evaluation for round 9...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 9:
   Loss: 159.8278, RMSE: 12.6423, R²: -316.2153
📈 Round 9 Centralized Test Evaluation:
   Loss: 159.8278
   RMSE: 12.6423
   R²: -316.2153
📊 Round 10 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7104.0074
   Avg Val Loss: 7032.5689
   Avg Val R²: -0.0181
🔍 Running centralized evaluation for round 10...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 10:
   Loss: 165.2719, RMSE: 12.8558, R²: -309.8204
📈 Round 10 Centralized Test Evaluation:
   Loss: 165.2719
   RMSE: 12.8558
   R²: -309.8204

==================================================
✅ Server completed successfully!
==================================================
🏁 Completion signal written to: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_111146/nasa_25c_alpha_0.5_fedavg/nasa_25c_alpha_0.5_fedavg/.COMPLETE
