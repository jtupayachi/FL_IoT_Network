[93mWARNING [0m:   DEPRECATED FEATURE: flwr.server.start_server() is deprecated.
	Instead, use the `flower-superlink` CLI command to start a SuperLink as shown below:

		$ flower-superlink --insecure

	To view usage and all available options, run:

		$ flower-superlink --help

	Using `start_server()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      Starting Flower server, config: num_rounds=10, no round_timeout
[92mINFO [0m:      Flower ECE: gRPC server running (10 rounds), SSL is disabled
[92mINFO [0m:      [INIT]
[92mINFO [0m:      Using initial global parameters provided by strategy
[92mINFO [0m:      Starting evaluation of initial global parameters
[92mINFO [0m:      initial parameters (loss, other metrics): 0.4645993113517761, {'rmse': 0.6816151738166809, 'mse': 0.46459925174713135, 'mae': 0.5453997254371643, 'r2': -0.005359530448913574}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 12 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 12 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
[92mINFO [0m:      fit progress: (1, 45.08597183227539, {'rmse': 6.714608669281006, 'mse': 45.08597183227539, 'mae': 6.663548469543457, 'r2': -118.62486267089844}, 38.94670199500251)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[93mWARNING [0m:   No evaluate_metrics_aggregation_fn provided
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (2, 10194.6591796875, {'rmse': 100.9686050415039, 'mse': 10194.6591796875, 'mae': 100.65904998779297, 'r2': -17518.267578125}, 41.64553147100378)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (3, 49861.88671875, {'rmse': 223.29776000976562, 'mse': 49861.890625, 'mae': 222.5910186767578, 'r2': -90718.375}, 44.301983053002914)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (4, 16650.951171875, {'rmse': 129.03857421875, 'mse': 16650.953125, 'mae': 128.80043029785156, 'r2': -42017.578125}, 46.86058482000226)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (5, 622.752197265625, {'rmse': 24.95500373840332, 'mse': 622.752197265625, 'mae': 24.92072296142578, 'r2': -1442.6455078125}, 51.94430534300045)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (6, 1.223125696182251, {'rmse': 1.105950117111206, 'mse': 1.2231255769729614, 'mae': 0.9555076360702515, 'r2': -1.4384777545928955}, 54.57427548799751)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (7, 0.529402494430542, {'rmse': 0.7276005148887634, 'mse': 0.529402494430542, 'mae': 0.5904445052146912, 'r2': -0.05775654315948486}, 57.16858561099798)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (8, 0.6222876906394958, {'rmse': 0.7888521552085876, 'mse': 0.6222876906394958, 'mae': 0.6340394616127014, 'r2': -0.047318220138549805}, 59.72984839799756)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (9, 0.5032555460929871, {'rmse': 0.7094050645828247, 'mse': 0.5032555460929871, 'mae': 0.5522394180297852, 'r2': -0.22516202926635742}, 64.7884796340004)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_fit: received 25 results and 0 failures
[92mINFO [0m:      fit progress: (10, 0.9939507246017456, {'rmse': 0.9969707727432251, 'mse': 0.9939506649971008, 'mae': 0.7841353416442871, 'r2': -0.6444617509841919}, 69.84598843200365)
[92mINFO [0m:      configure_evaluate: strategy sampled 25 clients (out of 25)
[92mINFO [0m:      aggregate_evaluate: received 25 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [SUMMARY]
[92mINFO [0m:      Run finished 10 round(s) in 70.19s
[92mINFO [0m:      	History (loss, distributed):
[92mINFO [0m:      		round 1: 9521.347048325808
[92mINFO [0m:      		round 2: 137479.72881497777
[92mINFO [0m:      		round 3: 293361.12812666886
[92mINFO [0m:      		round 4: 33287.66190236204
[92mINFO [0m:      		round 5: 13085.432230556733
[92mINFO [0m:      		round 6: 22298.613286219785
[92mINFO [0m:      		round 7: 22698.472667846163
[92mINFO [0m:      		round 8: 22662.805686058393
[92mINFO [0m:      		round 9: 22600.520542386243
[92mINFO [0m:      		round 10: 22514.49878516398
[92mINFO [0m:      	History (loss, centralized):
[92mINFO [0m:      		round 0: 0.4645993113517761
[92mINFO [0m:      		round 1: 45.08597183227539
[92mINFO [0m:      		round 2: 10194.6591796875
[92mINFO [0m:      		round 3: 49861.88671875
[92mINFO [0m:      		round 4: 16650.951171875
[92mINFO [0m:      		round 5: 622.752197265625
[92mINFO [0m:      		round 6: 1.223125696182251
[92mINFO [0m:      		round 7: 0.529402494430542
[92mINFO [0m:      		round 8: 0.6222876906394958
[92mINFO [0m:      		round 9: 0.5032555460929871
[92mINFO [0m:      		round 10: 0.9939507246017456
[92mINFO [0m:      	History (metrics, centralized):
[92mINFO [0m:      	{'mae': [(0, 0.5453997254371643),
[92mINFO [0m:      	         (1, 6.663548469543457),
[92mINFO [0m:      	         (2, 100.65904998779297),
[92mINFO [0m:      	         (3, 222.5910186767578),
[92mINFO [0m:      	         (4, 128.80043029785156),
[92mINFO [0m:      	         (5, 24.92072296142578),
[92mINFO [0m:      	         (6, 0.9555076360702515),
[92mINFO [0m:      	         (7, 0.5904445052146912),
[92mINFO [0m:      	         (8, 0.6340394616127014),
[92mINFO [0m:      	         (9, 0.5522394180297852),
[92mINFO [0m:      	         (10, 0.7841353416442871)],
[92mINFO [0m:      	 'mse': [(0, 0.46459925174713135),
[92mINFO [0m:      	         (1, 45.08597183227539),
[92mINFO [0m:      	         (2, 10194.6591796875),
[92mINFO [0m:      	         (3, 49861.890625),
[92mINFO [0m:      	         (4, 16650.953125),
[92mINFO [0m:      	         (5, 622.752197265625),
[92mINFO [0m:      	         (6, 1.2231255769729614),
[92mINFO [0m:      	         (7, 0.529402494430542),
[92mINFO [0m:      	         (8, 0.6222876906394958),
[92mINFO [0m:      	         (9, 0.5032555460929871),
[92mINFO [0m:      	         (10, 0.9939506649971008)],
[92mINFO [0m:      	 'r2': [(0, -0.005359530448913574),
[92mINFO [0m:      	        (1, -118.62486267089844),
[92mINFO [0m:      	        (2, -17518.267578125),
[92mINFO [0m:      	        (3, -90718.375),
[92mINFO [0m:      	        (4, -42017.578125),
[92mINFO [0m:      	        (5, -1442.6455078125),
[92mINFO [0m:      	        (6, -1.4384777545928955),
[92mINFO [0m:      	        (7, -0.05775654315948486),
[92mINFO [0m:      	        (8, -0.047318220138549805),
[92mINFO [0m:      	        (9, -0.22516202926635742),
[92mINFO [0m:      	        (10, -0.6444617509841919)],
[92mINFO [0m:      	 'rmse': [(0, 0.6816151738166809),
[92mINFO [0m:      	          (1, 6.714608669281006),
[92mINFO [0m:      	          (2, 100.9686050415039),
[92mINFO [0m:      	          (3, 223.29776000976562),
[92mINFO [0m:      	          (4, 129.03857421875),
[92mINFO [0m:      	          (5, 24.95500373840332),
[92mINFO [0m:      	          (6, 1.105950117111206),
[92mINFO [0m:      	          (7, 0.7276005148887634),
[92mINFO [0m:      	          (8, 0.7888521552085876),
[92mINFO [0m:      	          (9, 0.7094050645828247),
[92mINFO [0m:      	          (10, 0.9969707727432251)]}
[92mINFO [0m:      
🚀 Starting NASA Federated Learning Server
==================================================
Experiment ID: nasa_25c_alpha_0.5_fedavgm_server_momentum_0.9
Algorithm: FEDAVGM
Strategy: FEDAVGM
Server: localhost:8688
Rounds: 10

🔧 Strategy Parameters:
   server_momentum: 0.9

📁 Directory structure:
   Results: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_111146/nasa_25c_alpha_0.5_fedavgm_server_momentum_0.9/nasa_25c_alpha_0.5_fedavgm_server_momentum_0.9
   Metrics: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_111146/nasa_25c_alpha_0.5_fedavgm_server_momentum_0.9/nasa_25c_alpha_0.5_fedavgm_server_momentum_0.9/metrics
==================================================

⚙️ Creating FEDAVGM strategy...
   🔧 Generating initial parameters...

🎯 Starting federated learning...

🔍 Running centralized evaluation for round 0...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 0:
   Loss: 0.4646, RMSE: 0.6816, R²: -0.0054
📈 Round 0 Centralized Test Evaluation:
   Loss: 0.4646
   RMSE: 0.6816
   R²: -0.0054
⚠️ Could not update round metrics: list index out of range
📊 Round 1 Fit Metrics:
   Clients: 12
   Avg Train Loss: 9676.1084
   Avg Val Loss: 9580.4614
   Avg Val R²: -0.3261
🔍 Running centralized evaluation for round 1...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 1:
   Loss: 45.0860, RMSE: 6.7146, R²: -118.6249
📈 Round 1 Centralized Test Evaluation:
   Loss: 45.0860
   RMSE: 6.7146
   R²: -118.6249
📊 Round 2 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7077.9577
   Avg Val Loss: 7008.2328
   Avg Val R²: -0.0141
🔍 Running centralized evaluation for round 2...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 2:
   Loss: 10194.6592, RMSE: 100.9686, R²: -17518.2676
📈 Round 2 Centralized Test Evaluation:
   Loss: 10194.6592
   RMSE: 100.9686
   R²: -17518.2676
📊 Round 3 Fit Metrics:
   Clients: 25
   Avg Train Loss: 7697.5438
   Avg Val Loss: 7671.6615
   Avg Val R²: -0.1131
🔍 Running centralized evaluation for round 3...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 3:
   Loss: 49861.8867, RMSE: 223.2978, R²: -90718.3750
📈 Round 3 Centralized Test Evaluation:
   Loss: 49861.8867
   RMSE: 223.2978
   R²: -90718.3750
📊 Round 4 Fit Metrics:
   Clients: 25
   Avg Train Loss: 12907.8477
   Avg Val Loss: 12777.0617
   Avg Val R²: -0.9089
🔍 Running centralized evaluation for round 4...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 4:
   Loss: 16650.9512, RMSE: 129.0386, R²: -42017.5781
📈 Round 4 Centralized Test Evaluation:
   Loss: 16650.9512
   RMSE: 129.0386
   R²: -42017.5781
📊 Round 5 Fit Metrics:
   Clients: 25
   Avg Train Loss: 8536.6803
   Avg Val Loss: 8449.1886
   Avg Val R²: -0.2370
🔍 Running centralized evaluation for round 5...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 5:
   Loss: 622.7522, RMSE: 24.9550, R²: -1442.6455
📈 Round 5 Centralized Test Evaluation:
   Loss: 622.7522
   RMSE: 24.9550
   R²: -1442.6455
📊 Round 6 Fit Metrics:
   Clients: 25
   Avg Train Loss: 10841.4733
   Avg Val Loss: 10775.3209
   Avg Val R²: -0.5653
🔍 Running centralized evaluation for round 6...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 6:
   Loss: 1.2231, RMSE: 1.1060, R²: -1.4385
📈 Round 6 Centralized Test Evaluation:
   Loss: 1.2231
   RMSE: 1.1060
   R²: -1.4385
📊 Round 7 Fit Metrics:
   Clients: 25
   Avg Train Loss: 21589.0112
   Avg Val Loss: 21562.7095
   Avg Val R²: -2.1586
🔍 Running centralized evaluation for round 7...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 7:
   Loss: 0.5294, RMSE: 0.7276, R²: -0.0578
📈 Round 7 Centralized Test Evaluation:
   Loss: 0.5294
   RMSE: 0.7276
   R²: -0.0578
📊 Round 8 Fit Metrics:
   Clients: 25
   Avg Train Loss: 22395.8438
   Avg Val Loss: 22371.9785
   Avg Val R²: -2.2775
🔍 Running centralized evaluation for round 8...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 8:
   Loss: 0.6223, RMSE: 0.7889, R²: -0.0473
📈 Round 8 Centralized Test Evaluation:
   Loss: 0.6223
   RMSE: 0.7889
   R²: -0.0473
📊 Round 9 Fit Metrics:
   Clients: 25
   Avg Train Loss: 22360.5127
   Avg Val Loss: 22336.5606
   Avg Val R²: -2.2723
🔍 Running centralized evaluation for round 9...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 9:
   Loss: 0.5033, RMSE: 0.7094, R²: -0.2252
📈 Round 9 Centralized Test Evaluation:
   Loss: 0.5033
   RMSE: 0.7094
   R²: -0.2252
📊 Round 10 Fit Metrics:
   Clients: 25
   Avg Train Loss: 22298.8645
   Avg Val Loss: 22274.7620
   Avg Val R²: -2.2630
🔍 Running centralized evaluation for round 10...
📐 Detected LSTM architecture:
   Input dim: 5
   Hidden dim: 64 (from shape 256 / 4)
⚠️ Using synthetic test data with input_dim=5
📊 Centralized Evaluation - Round 10:
   Loss: 0.9940, RMSE: 0.9970, R²: -0.6445
📈 Round 10 Centralized Test Evaluation:
   Loss: 0.9940
   RMSE: 0.9970
   R²: -0.6445

==================================================
✅ Server completed successfully!
==================================================
🏁 Completion signal written to: /mnt/ceph_drive/FL_IoT_Network/scale/results/run_20251030_111146/nasa_25c_alpha_0.5_fedavgm_server_momentum_0.9/nasa_25c_alpha_0.5_fedavgm_server_momentum_0.9/.COMPLETE
