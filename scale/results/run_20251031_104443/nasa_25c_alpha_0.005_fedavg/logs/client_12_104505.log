[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_numpy_client() is deprecated. 
	Instead, use `flwr.client.start_client()` by ensuring you first call the `.to_client()` method as shown below: 
	flwr.client.start_client(
		server_address='<IP>:<PORT>',
		client=FlowerClient().to_client(), # <-- where FlowerClient is of type flwr.client.NumPyClient object
	)
	Using `start_numpy_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_client() is deprecated.
	Instead, use the `flower-supernode` CLI command to start a SuperNode as shown below:

		$ flower-supernode --insecure --superlink='<IP>:<PORT>'

	To view all available options, run:

		$ flower-supernode --help

	Using `start_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message d0a49376-22f9-4b0a-a2e4-6d48aec3e3d0
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 74227d54-c2d2-41ea-a15b-a9cf5b76899b
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 6c542266-184c-4d84-93ee-0c853ba2fa89
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 2f401b8c-636e-477d-be5b-db923681ecc7
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message b4224e68-5f6b-49b0-9be3-41ac8a6afd2d
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message ecd23b45-54e7-48a2-9fb8-6af8c312fa70
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 9e91eae6-9404-4e11-a007-cc65472e702f
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 0c17af23-7b3d-43a0-9219-a352865ebbb0
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message cced9471-110d-483a-9302-6995376050f7
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message b6b19463-26ca-496a-be62-38ec44e0776b
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 1ccfae17-3d9e-4a79-87c6-e4939d3a1856
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 684e9ba2-c553-4585-8f38-86be5ef3306e
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 67251092-bd8b-425a-b2fa-260549994bec
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message f6b60cd6-6620-4700-ba6c-b18096e85d26
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message ee47cbac-ba3e-4af9-89a5-f3cbdf320242
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message ce1411a6-a9d0-480a-8956-4320fd5bd56c
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 0d4d639a-a9b8-44f4-ad2e-0b980354b56d
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 7f3a8a86-e9d5-48b8-a7f2-fe2d0641f699
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 53a9eeea-b211-4617-b06f-38b27b62c92b
[92mINFO [0m:      Sent reply
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_status:14, grpc_message:"Socket closed"}"
>

================================================================================
🚀 NASA C-MAPSS Federated Learning Client
================================================================================
Client ID: client_12
Server: localhost:8686
Algorithm: FEDAVG
================================================================================

   🔧 LSTM config: hidden_dim=64, num_layers=2
   ✅ Converted to hidden_dims=[64, 64]
🖥️  Using device: cuda
✅ Found client data directory with all required files

📊 NASADataLoader initialized:
   Data path: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_12
   RUL mode: linear
   RUL power: 1
   Reduction: kpca

📂 Loading data files:
   Train data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_12/train_data.txt
   Train labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_12/train_labels.txt
   Test data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_12/test_data.txt
   Test labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_12/test_labels.txt

📊 Raw data loaded:
   Train: X=(3825, 24), y=(3825,)
   Test:  X=(957, 24), y=(957,)

🔧 Applying StandardScaler...

🔄 Creating LSTM sequences (length=10)...

✅ Data loading complete!
   Train: 3816 samples, 5 features
   Test:  948 samples, 5 features

📊 Round 0 Test Metrics:
   Test Loss: 0.1351, RMSE: 0.3676, MAE: 0.2896, R²: -0.6933

📊 Round 0 Test Metrics:
   Test Loss: 0.1284, RMSE: 0.3583, MAE: 0.2929, R²: -0.6084

📊 Round 0 Test Metrics:
   Test Loss: 0.1080, RMSE: 0.3287, MAE: 0.2704, R²: -0.3536

📊 Round 0 Test Metrics:
   Test Loss: 0.1081, RMSE: 0.3288, MAE: 0.2678, R²: -0.3549

📊 Round 0 Test Metrics:
   Test Loss: 0.1150, RMSE: 0.3391, MAE: 0.2740, R²: -0.4412

📊 Round 7 Training Metrics:
   Train Loss: 0.0040, RMSE: 0.0629, R²: 0.9529
   Val   Loss: 0.0844, RMSE: 0.2905, R²: 0.0093

📊 Round 7 Test Metrics:
   Test Loss: 0.1226, RMSE: 0.3501, MAE: 0.2841, R²: -0.5358

📊 Round 7 Test Metrics:
   Test Loss: 0.1023, RMSE: 0.3199, MAE: 0.2612, R²: -0.2820

📊 Round 13 Training Metrics:
   Train Loss: 0.0010, RMSE: 0.0316, R²: 0.9883
   Val   Loss: 0.0809, RMSE: 0.2844, R²: 0.0086

📊 Round 13 Test Metrics:
   Test Loss: 0.1032, RMSE: 0.3212, MAE: 0.2611, R²: -0.2926

📊 Round 14 Training Metrics:
   Train Loss: 0.0018, RMSE: 0.0427, R²: 0.9785
   Val   Loss: 0.0773, RMSE: 0.2779, R²: 0.0369

📊 Round 15 Training Metrics:
   Train Loss: 0.0015, RMSE: 0.0387, R²: 0.9824
   Val   Loss: 0.0691, RMSE: 0.2628, R²: 0.1338

📊 Round 15 Test Metrics:
   Test Loss: 0.0925, RMSE: 0.3042, MAE: 0.2460, R²: -0.1593

📊 Round 16 Training Metrics:
   Train Loss: 0.0023, RMSE: 0.0484, R²: 0.9722
   Val   Loss: 0.0666, RMSE: 0.2581, R²: 0.2059

📊 Round 16 Test Metrics:
   Test Loss: 0.0825, RMSE: 0.2872, MAE: 0.2325, R²: -0.0336

📊 Round 17 Training Metrics:
   Train Loss: 0.0015, RMSE: 0.0388, R²: 0.9822
   Val   Loss: 0.0690, RMSE: 0.2626, R²: 0.1805

📊 Round 17 Test Metrics:
   Test Loss: 0.1100, RMSE: 0.3317, MAE: 0.2645, R²: -0.3789

📊 Round 24 Training Metrics:
   Train Loss: 0.0032, RMSE: 0.0563, R²: 0.9623
   Val   Loss: 0.0739, RMSE: 0.2719, R²: 0.1168

📊 Round 24 Test Metrics:
   Test Loss: 0.1027, RMSE: 0.3204, MAE: 0.2559, R²: -0.2867

❌ Client client_12 error: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_status:14, grpc_message:"Socket closed"}"
>
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 942, in <module>
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_status:14, grpc_message:"Socket closed"}"
>
