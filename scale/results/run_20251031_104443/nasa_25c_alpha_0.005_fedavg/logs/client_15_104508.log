[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_numpy_client() is deprecated. 
	Instead, use `flwr.client.start_client()` by ensuring you first call the `.to_client()` method as shown below: 
	flwr.client.start_client(
		server_address='<IP>:<PORT>',
		client=FlowerClient().to_client(), # <-- where FlowerClient is of type flwr.client.NumPyClient object
	)
	Using `start_numpy_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_client() is deprecated.
	Instead, use the `flower-supernode` CLI command to start a SuperNode as shown below:

		$ flower-supernode --insecure --superlink='<IP>:<PORT>'

	To view all available options, run:

		$ flower-supernode --help

	Using `start_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 362e9385-e36e-4b6d-9aa8-3802d5c07f2d
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 5036c04c-0592-4a3d-bae3-e8fb6d5cb5e9
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message dc649536-5732-43ec-8c2b-13f4f5f37c99
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 0b1c9b80-a078-46d0-b81d-b0b7d61774e0
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message b3fbc25b-1d17-408f-8364-e6e0ab43afad
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 1a7e8ab1-6853-4994-bb49-01c001496c0f
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message b7c1215f-8b3f-4d76-9e85-051055a607aa
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 4b15a397-0a72-4ef1-ac73-b8071bed8def
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 57d31886-86a0-47ce-8f7c-6e94db9beed1
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 72b33a53-1414-4189-83f3-62fa2b20d5df
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 4ad32df2-b5bc-47d0-91a5-0ab231bbcf86
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 95495f2e-572a-4c3b-8fee-89871ced98f6
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 637f250b-478b-46bd-86af-4d7ea9502ad3
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message dbfd7dce-bece-4a12-bb7e-643a53ccc43a
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 4a173a46-13f7-4ace-8013-7f7ee90e4311
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message a37ba7b6-f57d-49e6-9e38-87934d13820d
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 943eab50-14dc-4015-81ec-387b7a0df742
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message e1f11e07-ca02-488c-b04d-519b64ab74c0
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 4bcae756-dd73-4fb3-b18c-fc106c96fe68
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message ada9b44a-c048-4ea8-a1f9-251859d514f7
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 935fad23-21d5-4a4e-a3e8-5ac2662b3ce6
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message c53055e0-87f6-400c-aef3-feaf979ee02b
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 4c1ef572-0cc0-46c7-80eb-895877a1993a
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 9096ed7e-86cc-406d-857e-43cedb3af2fe
[92mINFO [0m:      Sent reply
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>

================================================================================
🚀 NASA C-MAPSS Federated Learning Client
================================================================================
Client ID: client_15
Server: localhost:8686
Algorithm: FEDAVG
================================================================================

   🔧 LSTM config: hidden_dim=64, num_layers=2
   ✅ Converted to hidden_dims=[64, 64]
🖥️  Using device: cuda
✅ Found client data directory with all required files

📊 NASADataLoader initialized:
   Data path: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_15
   RUL mode: linear
   RUL power: 1
   Reduction: kpca

📂 Loading data files:
   Train data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_15/train_data.txt
   Train labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_15/train_labels.txt
   Test data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_15/test_data.txt
   Test labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_15/test_labels.txt

📊 Raw data loaded:
   Train: X=(5848, 24), y=(5848,)
   Test:  X=(1463, 24), y=(1463,)

🔧 Applying StandardScaler...

🔄 Creating LSTM sequences (length=10)...

✅ Data loading complete!
   Train: 5839 samples, 5 features
   Test:  1454 samples, 5 features

📊 Round 1 Training Metrics:
   Train Loss: 0.0104, RMSE: 0.1021, R²: 0.8740
   Val   Loss: 0.0999, RMSE: 0.3161, R²: -0.1871

📊 Round 2 Training Metrics:
   Train Loss: 0.0090, RMSE: 0.0949, R²: 0.8920
   Val   Loss: 0.0843, RMSE: 0.2904, R²: -0.0267

📊 Round 2 Test Metrics:
   Test Loss: 0.1312, RMSE: 0.3622, MAE: 0.2904, R²: -0.5907

📊 Round 3 Training Metrics:
   Train Loss: 0.0105, RMSE: 0.1024, R²: 0.8743
   Val   Loss: 0.0905, RMSE: 0.3008, R²: -0.1142

📊 Round 3 Test Metrics:
   Test Loss: 0.1242, RMSE: 0.3525, MAE: 0.2876, R²: -0.5065

📊 Round 5 Training Metrics:
   Train Loss: 0.0067, RMSE: 0.0819, R²: 0.9193
   Val   Loss: 0.0796, RMSE: 0.2821, R²: 0.0370

📊 Round 5 Test Metrics:
   Test Loss: 0.1185, RMSE: 0.3442, MAE: 0.2782, R²: -0.4364

📊 Round 5 Test Metrics:
   Test Loss: 0.1221, RMSE: 0.3495, MAE: 0.2833, R²: -0.4811

📊 Round 9 Training Metrics:
   Train Loss: 0.0023, RMSE: 0.0485, R²: 0.9716
   Val   Loss: 0.0840, RMSE: 0.2899, R²: 0.0083

📊 Round 11 Training Metrics:
   Train Loss: 0.0063, RMSE: 0.0792, R²: 0.9250
   Val   Loss: 0.0803, RMSE: 0.2833, R²: 0.0074

📊 Round 11 Test Metrics:
   Test Loss: 0.1073, RMSE: 0.3276, MAE: 0.2667, R²: -0.3012

📊 Round 12 Training Metrics:
   Train Loss: 0.0040, RMSE: 0.0632, R²: 0.9520
   Val   Loss: 0.0723, RMSE: 0.2688, R²: 0.1244

📊 Round 12 Test Metrics:
   Test Loss: 0.1056, RMSE: 0.3250, MAE: 0.2619, R²: -0.2805

📊 Round 12 Test Metrics:
   Test Loss: 0.1079, RMSE: 0.3284, MAE: 0.2670, R²: -0.3079

📊 Round 14 Training Metrics:
   Train Loss: 0.0054, RMSE: 0.0735, R²: 0.9353
   Val   Loss: 0.0702, RMSE: 0.2649, R²: 0.1391

📊 Round 14 Test Metrics:
   Test Loss: 0.1089, RMSE: 0.3301, MAE: 0.2648, R²: -0.3210

📊 Round 15 Training Metrics:
   Train Loss: 0.0032, RMSE: 0.0569, R²: 0.9610
   Val   Loss: 0.0633, RMSE: 0.2517, R²: 0.2403

📊 Round 16 Training Metrics:
   Train Loss: 0.0026, RMSE: 0.0511, R²: 0.9689
   Val   Loss: 0.0601, RMSE: 0.2452, R²: 0.2507

📊 Round 21 Training Metrics:
   Train Loss: 0.0026, RMSE: 0.0513, R²: 0.9685
   Val   Loss: 0.0624, RMSE: 0.2497, R²: 0.2391

📊 Round 21 Test Metrics:
   Test Loss: 0.0966, RMSE: 0.3107, MAE: 0.2502, R²: -0.1707

📊 Round 21 Test Metrics:
   Test Loss: 0.1058, RMSE: 0.3253, MAE: 0.2620, R²: -0.2829

📊 Round 23 Training Metrics:
   Train Loss: 0.0047, RMSE: 0.0685, R²: 0.9430
   Val   Loss: 0.0669, RMSE: 0.2587, R²: 0.2275

📊 Round 24 Training Metrics:
   Train Loss: 0.0051, RMSE: 0.0715, R²: 0.9382
   Val   Loss: 0.0585, RMSE: 0.2418, R²: 0.3093

📊 Round 24 Test Metrics:
   Test Loss: 0.0944, RMSE: 0.3072, MAE: 0.2463, R²: -0.1446

❌ Client client_15 error: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 942, in <module>
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>
