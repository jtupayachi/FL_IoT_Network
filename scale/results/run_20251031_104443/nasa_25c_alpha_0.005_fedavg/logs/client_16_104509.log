[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_numpy_client() is deprecated. 
	Instead, use `flwr.client.start_client()` by ensuring you first call the `.to_client()` method as shown below: 
	flwr.client.start_client(
		server_address='<IP>:<PORT>',
		client=FlowerClient().to_client(), # <-- where FlowerClient is of type flwr.client.NumPyClient object
	)
	Using `start_numpy_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_client() is deprecated.
	Instead, use the `flower-supernode` CLI command to start a SuperNode as shown below:

		$ flower-supernode --insecure --superlink='<IP>:<PORT>'

	To view all available options, run:

		$ flower-supernode --help

	Using `start_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 5cc3f5f2-bff4-4ab6-ac7f-bb7ba5591bb3
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message d1d74fec-8542-4984-ad6e-6bf91886bf51
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 13df00d1-f23c-4dbf-9c7c-ef8958785958
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 3bcfca7b-ba66-4297-b031-e39b3b41ff2f
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 5c5211c2-8ad4-47a1-a770-1123ed4685b6
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message bb7647d0-cda7-4056-a5ce-e3f10de5a3b4
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 00ea0a54-78fd-40e8-9dc8-1d2a1de7ce09
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 77425c53-1c2d-4b1e-96a8-a9826bbb94d7
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 0948f89e-8123-4771-91ec-b004dd0890f7
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 116779d5-d129-4909-a913-3ef72ed8a0e8
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 80be075b-76e7-401c-b77c-d82c5cbbe7fb
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 6859b4a7-442d-4d03-bde0-5f4a406810e4
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 459adbb3-dc4e-4529-a16c-0a4ae3fea8dd
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 1a106e11-7591-4065-b732-75ec6c10de45
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 49f5159d-890c-4a2b-bbd2-2a3f6aeac7c7
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 8fd319fe-88b2-4262-aa9f-1042ae4deb97
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message f246a2ca-b3dc-440b-bffb-ac2c71259ce3
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message e298071c-080e-4b47-b52e-adaba4407637
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message ca8a089f-0043-40e0-a699-25b696343169
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 28a47899-b6b2-47b8-b8ea-13f9cea523ce
[92mINFO [0m:      Sent reply
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_status:14, grpc_message:"Socket closed"}"
>

================================================================================
🚀 NASA C-MAPSS Federated Learning Client
================================================================================
Client ID: client_16
Server: localhost:8686
Algorithm: FEDAVG
================================================================================

   🔧 LSTM config: hidden_dim=64, num_layers=2
   ✅ Converted to hidden_dims=[64, 64]
🖥️  Using device: cuda
✅ Found client data directory with all required files

📊 NASADataLoader initialized:
   Data path: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_16
   RUL mode: linear
   RUL power: 1
   Reduction: kpca

📂 Loading data files:
   Train data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_16/train_data.txt
   Train labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_16/train_labels.txt
   Test data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_16/test_data.txt
   Test labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_16/test_labels.txt

📊 Raw data loaded:
   Train: X=(5337, 24), y=(5337,)
   Test:  X=(1335, 24), y=(1335,)

🔧 Applying StandardScaler...

🔄 Creating LSTM sequences (length=10)...

✅ Data loading complete!
   Train: 5328 samples, 5 features
   Test:  1326 samples, 5 features

📊 Round 1 Training Metrics:
   Train Loss: 0.0088, RMSE: 0.0940, R²: 0.8936
   Val   Loss: 0.1027, RMSE: 0.3205, R²: -0.2625

📊 Round 1 Test Metrics:
   Test Loss: 0.1043, RMSE: 0.3229, MAE: 0.2660, R²: -0.2335

📊 Round 1 Test Metrics:
   Test Loss: 0.0832, RMSE: 0.2885, MAE: 0.2351, R²: 0.0157

📊 Round 1 Test Metrics:
   Test Loss: 0.0792, RMSE: 0.2814, MAE: 0.2300, R²: 0.0636

📊 Round 7 Training Metrics:
   Train Loss: 0.0107, RMSE: 0.1033, R²: 0.8705
   Val   Loss: 0.0965, RMSE: 0.3106, R²: -0.1521

📊 Round 8 Training Metrics:
   Train Loss: 0.0032, RMSE: 0.0562, R²: 0.9616
   Val   Loss: 0.0732, RMSE: 0.2706, R²: 0.1270

📊 Round 8 Test Metrics:
   Test Loss: 0.0756, RMSE: 0.2750, MAE: 0.2248, R²: 0.1052

📊 Round 10 Training Metrics:
   Train Loss: 0.0037, RMSE: 0.0605, R²: 0.9560
   Val   Loss: 0.0661, RMSE: 0.2572, R²: 0.1802

📊 Round 10 Test Metrics:
   Test Loss: 0.0753, RMSE: 0.2744, MAE: 0.2240, R²: 0.1093

📊 Round 12 Training Metrics:
   Train Loss: 0.0035, RMSE: 0.0589, R²: 0.9581
   Val   Loss: 0.0663, RMSE: 0.2575, R²: 0.1874

📊 Round 13 Training Metrics:
   Train Loss: 0.0032, RMSE: 0.0567, R²: 0.9612
   Val   Loss: 0.0616, RMSE: 0.2483, R²: 0.2460

📊 Round 14 Training Metrics:
   Train Loss: 0.0038, RMSE: 0.0613, R²: 0.9547
   Val   Loss: 0.0559, RMSE: 0.2365, R²: 0.3119

📊 Round 14 Test Metrics:
   Test Loss: 0.0773, RMSE: 0.2780, MAE: 0.2254, R²: 0.0858

📊 Round 16 Training Metrics:
   Train Loss: 0.0031, RMSE: 0.0556, R²: 0.9626
   Val   Loss: 0.0549, RMSE: 0.2344, R²: 0.3385

📊 Round 16 Test Metrics:
   Test Loss: 0.0779, RMSE: 0.2792, MAE: 0.2270, R²: 0.0782

📊 Round 17 Training Metrics:
   Train Loss: 0.0021, RMSE: 0.0453, R²: 0.9752
   Val   Loss: 0.0518, RMSE: 0.2276, R²: 0.3707

📊 Round 17 Test Metrics:
   Test Loss: 0.0768, RMSE: 0.2771, MAE: 0.2250, R²: 0.0916

📊 Round 23 Training Metrics:
   Train Loss: 0.0024, RMSE: 0.0486, R²: 0.9715
   Val   Loss: 0.0562, RMSE: 0.2370, R²: 0.3179

📊 Round 23 Test Metrics:
   Test Loss: 0.0777, RMSE: 0.2788, MAE: 0.2269, R²: 0.0805

📊 Round 23 Test Metrics:
   Test Loss: 0.0830, RMSE: 0.2880, MAE: 0.2336, R²: 0.0188

❌ Client client_16 error: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_status:14, grpc_message:"Socket closed"}"
>
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 942, in <module>
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_status:14, grpc_message:"Socket closed"}"
>
