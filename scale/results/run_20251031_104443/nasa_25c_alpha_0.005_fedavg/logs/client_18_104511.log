[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_numpy_client() is deprecated. 
	Instead, use `flwr.client.start_client()` by ensuring you first call the `.to_client()` method as shown below: 
	flwr.client.start_client(
		server_address='<IP>:<PORT>',
		client=FlowerClient().to_client(), # <-- where FlowerClient is of type flwr.client.NumPyClient object
	)
	Using `start_numpy_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_client() is deprecated.
	Instead, use the `flower-supernode` CLI command to start a SuperNode as shown below:

		$ flower-supernode --insecure --superlink='<IP>:<PORT>'

	To view all available options, run:

		$ flower-supernode --help

	Using `start_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 24b8db6f-f245-4120-98f4-2edc9e958c32
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message e830afad-3a17-4c85-8064-eb0de7bb8ffe
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 02dcc5a0-d228-40aa-9aff-5428cbea8868
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 0ebbd577-ea6e-478a-99a4-c7304373de0c
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 733e8f2a-004d-461f-b7dc-d39d77c70d4f
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 152ba941-2305-40dd-99ad-541dee448c44
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 2688aa03-bf93-4df5-8c0c-b75468f6bd30
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message f37ef298-9abe-4a6e-bf07-44998aa9a6a7
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message f91c4c2a-bccc-4394-9369-be60b3ce1c1b
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message f53433ff-c2cb-4568-8ce5-2d818bea8af4
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 474fbec8-baf5-4bdd-8817-74a3a7f1dc3b
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 1ca82086-f352-4b2e-80ff-8ddca27f9982
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message aa7e241e-eacb-4d25-a671-f0c737088772
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 65399580-8d89-4eec-8f79-12f83c4d3b72
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 64dd2f85-ade4-4a00-bf56-648429739edc
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message d73d9676-e6cd-41dc-8b73-1ee1ee563293
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 1edfef7c-ef4f-472d-9881-51017c282a69
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message d65419b9-17e8-41e6-bd67-76007e14f4ba
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 44b0e969-48fc-4f15-8509-5d4624493069
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message f965290c-72c1-471b-9a55-d32cf724174c
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message dc3e0c42-c5fd-4612-93dd-f0b3160f4eff
[92mINFO [0m:      Sent reply
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>

================================================================================
🚀 NASA C-MAPSS Federated Learning Client
================================================================================
Client ID: client_18
Server: localhost:8686
Algorithm: FEDAVG
================================================================================

   🔧 LSTM config: hidden_dim=64, num_layers=2
   ✅ Converted to hidden_dims=[64, 64]
🖥️  Using device: cuda
✅ Found client data directory with all required files

📊 NASADataLoader initialized:
   Data path: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_18
   RUL mode: linear
   RUL power: 1
   Reduction: kpca

📂 Loading data files:
   Train data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_18/train_data.txt
   Train labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_18/train_labels.txt
   Test data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_18/test_data.txt
   Test labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_18/test_labels.txt

📊 Raw data loaded:
   Train: X=(6860, 24), y=(6860,)
   Test:  X=(1715, 24), y=(1715,)

🔧 Applying StandardScaler...

🔄 Creating LSTM sequences (length=10)...

✅ Data loading complete!
   Train: 6851 samples, 5 features
   Test:  1706 samples, 5 features

📊 Round 3 Training Metrics:
   Train Loss: 0.0113, RMSE: 0.1063, R²: 0.8663
   Val   Loss: 0.0858, RMSE: 0.2928, R²: -0.0459

📊 Round 3 Test Metrics:
   Test Loss: 0.0908, RMSE: 0.3013, MAE: 0.2468, R²: -0.1577

📊 Round 3 Test Metrics:
   Test Loss: 0.0841, RMSE: 0.2899, MAE: 0.2371, R²: -0.0723

📊 Round 6 Training Metrics:
   Train Loss: 0.0038, RMSE: 0.0620, R²: 0.9545
   Val   Loss: 0.0745, RMSE: 0.2729, R²: 0.0917

📊 Round 6 Test Metrics:
   Test Loss: 0.0721, RMSE: 0.2685, MAE: 0.2214, R²: 0.0804

📊 Round 11 Training Metrics:
   Train Loss: 0.0028, RMSE: 0.0525, R²: 0.9672
   Val   Loss: 0.0650, RMSE: 0.2550, R²: 0.2161

📊 Round 11 Test Metrics:
   Test Loss: 0.0716, RMSE: 0.2676, MAE: 0.2196, R²: 0.0864

📊 Round 14 Training Metrics:
   Train Loss: 0.0032, RMSE: 0.0564, R²: 0.9623
   Val   Loss: 0.0659, RMSE: 0.2568, R²: 0.2000

📊 Round 15 Training Metrics:
   Train Loss: 0.0017, RMSE: 0.0412, R²: 0.9798
   Val   Loss: 0.0544, RMSE: 0.2331, R²: 0.3525

📊 Round 15 Test Metrics:
   Test Loss: 0.0766, RMSE: 0.2767, MAE: 0.2250, R²: 0.0231

📊 Round 15 Test Metrics:
   Test Loss: 0.0766, RMSE: 0.2768, MAE: 0.2248, R²: 0.0231

📊 Round 18 Training Metrics:
   Train Loss: 0.0019, RMSE: 0.0436, R²: 0.9773
   Val   Loss: 0.0555, RMSE: 0.2357, R²: 0.3421

📊 Round 19 Training Metrics:
   Train Loss: 0.0035, RMSE: 0.0592, R²: 0.9580
   Val   Loss: 0.0547, RMSE: 0.2338, R²: 0.3637

📊 Round 19 Test Metrics:
   Test Loss: 0.0735, RMSE: 0.2711, MAE: 0.2222, R²: 0.0626

📊 Round 21 Training Metrics:
   Train Loss: 0.0019, RMSE: 0.0430, R²: 0.9780
   Val   Loss: 0.0505, RMSE: 0.2248, R²: 0.3949

📊 Round 21 Test Metrics:
   Test Loss: 0.0709, RMSE: 0.2663, MAE: 0.2180, R²: 0.0954

📊 Round 22 Training Metrics:
   Train Loss: 0.0011, RMSE: 0.0334, R²: 0.9867
   Val   Loss: 0.0439, RMSE: 0.2096, R²: 0.4727

📊 Round 22 Test Metrics:
   Test Loss: 0.0646, RMSE: 0.2542, MAE: 0.2053, R²: 0.1758

📊 Round 23 Training Metrics:
   Train Loss: 0.0013, RMSE: 0.0358, R²: 0.9846
   Val   Loss: 0.0425, RMSE: 0.2062, R²: 0.5042

📊 Round 23 Test Metrics:
   Test Loss: 0.0664, RMSE: 0.2576, MAE: 0.2084, R²: 0.1536

📊 Round 23 Test Metrics:
   Test Loss: 0.0692, RMSE: 0.2630, MAE: 0.2134, R²: 0.1179

❌ Client client_18 error: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 942, in <module>
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>
