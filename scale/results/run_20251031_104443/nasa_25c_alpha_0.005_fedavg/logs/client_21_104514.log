[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_numpy_client() is deprecated. 
	Instead, use `flwr.client.start_client()` by ensuring you first call the `.to_client()` method as shown below: 
	flwr.client.start_client(
		server_address='<IP>:<PORT>',
		client=FlowerClient().to_client(), # <-- where FlowerClient is of type flwr.client.NumPyClient object
	)
	Using `start_numpy_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_client() is deprecated.
	Instead, use the `flower-supernode` CLI command to start a SuperNode as shown below:

		$ flower-supernode --insecure --superlink='<IP>:<PORT>'

	To view all available options, run:

		$ flower-supernode --help

	Using `start_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 27b123dd-fb39-428f-864e-70b9aa067d48
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 1df0bce1-7960-41dd-9e91-6ff1809ef718
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 97c7c2bc-d97b-41f2-ab26-3c26b6c01f62
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 869c685d-d48e-4c95-9007-41d36d5ba082
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message afd3fce9-fc0c-440c-8f01-4fa1352c7985
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message c75252a4-90a2-42d3-9c6d-db1fea6be46d
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message f2780a15-538b-428a-9647-6b8c7f957a4d
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 578e1123-4952-4834-a82a-9be668179c09
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 3923b093-2ca1-49cd-a97a-a20c4f39bb83
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 033f958e-41ab-4a51-be2f-eff0201a7e2e
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 38660674-5911-407e-8711-80e2b63c7f75
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 0e307934-73b4-49df-af3a-3d24aac2e158
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message b1115dc9-3861-4fc0-a1db-0f921ba516b5
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 23cd819f-58f3-4d18-b210-9db2dee555a5
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message d24d9cae-7e27-4082-a864-d2c070371f80
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 82bca53b-441a-446a-878c-738edf58c5dd
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 54c86315-2aeb-4c34-a22c-860e91ae6cfb
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 14fcff0b-def9-41f8-90c1-a812f7813330
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 859666ed-3312-4b3d-8451-fa82a9d57194
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 3e8dfb7e-9839-434b-b1f7-5c9415666ab6
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 3f8db2dc-894c-4fbb-998e-7827a616f94b
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 873aae77-fab6-4bf1-8e7b-9046fa9b03e1
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 79f0874e-3381-4477-aa1d-d2b13e39a514
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message d8710eaf-9cd7-4ccc-8632-220c82bfd530
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 50dd6106-5125-4e0e-8b3a-93ba9f0b49ab
[92mINFO [0m:      Sent reply
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>

================================================================================
🚀 NASA C-MAPSS Federated Learning Client
================================================================================
Client ID: client_21
Server: localhost:8686
Algorithm: FEDAVG
================================================================================

   🔧 LSTM config: hidden_dim=64, num_layers=2
   ✅ Converted to hidden_dims=[64, 64]
🖥️  Using device: cuda
✅ Found client data directory with all required files

📊 NASADataLoader initialized:
   Data path: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_21
   RUL mode: linear
   RUL power: 1
   Reduction: kpca

📂 Loading data files:
   Train data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_21/train_data.txt
   Train labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_21/train_labels.txt
   Test data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_21/test_data.txt
   Test labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_21/test_labels.txt

📊 Raw data loaded:
   Train: X=(5927, 24), y=(5927,)
   Test:  X=(1482, 24), y=(1482,)

🔧 Applying StandardScaler...

🔄 Creating LSTM sequences (length=10)...

✅ Data loading complete!
   Train: 5918 samples, 5 features
   Test:  1473 samples, 5 features

📊 Round 0 Test Metrics:
   Test Loss: 0.1497, RMSE: 0.3869, MAE: 0.3219, R²: -0.7535

📊 Round 2 Training Metrics:
   Train Loss: 0.0127, RMSE: 0.1128, R²: 0.8463
   Val   Loss: 0.0942, RMSE: 0.3069, R²: -0.1632

📊 Round 4 Training Metrics:
   Train Loss: 0.0032, RMSE: 0.0566, R²: 0.9612
   Val   Loss: 0.0707, RMSE: 0.2659, R²: 0.1445

📊 Round 4 Test Metrics:
   Test Loss: 0.0770, RMSE: 0.2775, MAE: 0.2265, R²: 0.0977

📊 Round 4 Test Metrics:
   Test Loss: 0.0770, RMSE: 0.2776, MAE: 0.2260, R²: 0.0973

📊 Round 6 Training Metrics:
   Train Loss: 0.0034, RMSE: 0.0582, R²: 0.9589
   Val   Loss: 0.0680, RMSE: 0.2608, R²: 0.1742

📊 Round 6 Test Metrics:
   Test Loss: 0.0713, RMSE: 0.2670, MAE: 0.2171, R²: 0.1646

📊 Round 6 Test Metrics:
   Test Loss: 0.0744, RMSE: 0.2727, MAE: 0.2221, R²: 0.1288

📊 Round 8 Training Metrics:
   Train Loss: 0.0027, RMSE: 0.0518, R²: 0.9674
   Val   Loss: 0.0648, RMSE: 0.2545, R²: 0.2286

📊 Round 9 Training Metrics:
   Train Loss: 0.0027, RMSE: 0.0515, R²: 0.9681
   Val   Loss: 0.0590, RMSE: 0.2430, R²: 0.2567

📊 Round 9 Test Metrics:
   Test Loss: 0.0700, RMSE: 0.2645, MAE: 0.2149, R²: 0.1803

📊 Round 13 Training Metrics:
   Train Loss: 0.0029, RMSE: 0.0535, R²: 0.9653
   Val   Loss: 0.0584, RMSE: 0.2417, R²: 0.2805

📊 Round 14 Training Metrics:
   Train Loss: 0.0026, RMSE: 0.0510, R²: 0.9684
   Val   Loss: 0.0531, RMSE: 0.2305, R²: 0.3610

📊 Round 14 Test Metrics:
   Test Loss: 0.0751, RMSE: 0.2740, MAE: 0.2235, R²: 0.1201

📊 Round 16 Training Metrics:
   Train Loss: 0.0052, RMSE: 0.0719, R²: 0.9378
   Val   Loss: 0.0559, RMSE: 0.2363, R²: 0.2995

📊 Round 16 Test Metrics:
   Test Loss: 0.0783, RMSE: 0.2799, MAE: 0.2288, R²: 0.0823

📊 Round 17 Training Metrics:
   Train Loss: 0.0010, RMSE: 0.0308, R²: 0.9884
   Val   Loss: 0.0522, RMSE: 0.2284, R²: 0.3791

📊 Round 17 Test Metrics:
   Test Loss: 0.0728, RMSE: 0.2698, MAE: 0.2196, R²: 0.1471

📊 Round 19 Training Metrics:
   Train Loss: 0.0035, RMSE: 0.0591, R²: 0.9570
   Val   Loss: 0.0514, RMSE: 0.2267, R²: 0.4118

📊 Round 20 Training Metrics:
   Train Loss: 0.0013, RMSE: 0.0365, R²: 0.9837
   Val   Loss: 0.0439, RMSE: 0.2095, R²: 0.4906

📊 Round 20 Test Metrics:
   Test Loss: 0.0709, RMSE: 0.2663, MAE: 0.2169, R²: 0.1692

📊 Round 21 Training Metrics:
   Train Loss: 0.0030, RMSE: 0.0546, R²: 0.9638
   Val   Loss: 0.0451, RMSE: 0.2125, R²: 0.4562

📊 Round 21 Test Metrics:
   Test Loss: 0.0695, RMSE: 0.2637, MAE: 0.2147, R²: 0.1852

📊 Round 21 Test Metrics:
   Test Loss: 0.0700, RMSE: 0.2645, MAE: 0.2142, R²: 0.1803

📊 Round 23 Training Metrics:
   Train Loss: 0.0029, RMSE: 0.0541, R²: 0.9645
   Val   Loss: 0.0440, RMSE: 0.2098, R²: 0.4703

❌ Client client_21 error: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 942, in <module>
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>
