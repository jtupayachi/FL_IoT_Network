[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_numpy_client() is deprecated. 
	Instead, use `flwr.client.start_client()` by ensuring you first call the `.to_client()` method as shown below: 
	flwr.client.start_client(
		server_address='<IP>:<PORT>',
		client=FlowerClient().to_client(), # <-- where FlowerClient is of type flwr.client.NumPyClient object
	)
	Using `start_numpy_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_client() is deprecated.
	Instead, use the `flower-supernode` CLI command to start a SuperNode as shown below:

		$ flower-supernode --insecure --superlink='<IP>:<PORT>'

	To view all available options, run:

		$ flower-supernode --help

	Using `start_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 68f8b0d7-52a7-4977-b2fd-764393a94165
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 8a05506b-ed31-415b-94ba-a22ef4b072f3
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 568a3322-5bce-4831-8a65-b853731f9c5b
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 0033314c-a605-4833-ad83-e7cef3e3fab7
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 1a788067-a920-4bfa-b495-0410a4a1cd01
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message f58b89f6-c83a-46fb-8b6f-95a4d01615ea
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 2460824e-b6a8-4cd6-9e5f-ccae67479ba9
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message f5da218e-787e-4320-b60c-744adf2176b0
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 4b6bc582-8fc6-47eb-8cee-eebb2b0c7517
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 3cf7a3c2-7c01-45e3-8199-c6f38f3ef3b2
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message a5e497ee-1fe6-477e-a739-59b07c6fb808
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 507beea4-02d7-42d4-8d0a-1ef2801b037e
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message ce2d2948-62f8-423a-aa69-543f3524e092
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 410d3edd-f4b4-4e49-a6c9-026d36419c73
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 7f2a09e1-218e-4634-a9bc-ec104648ab8d
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 9bead567-294f-4354-8584-0dd6c7efcad8
[92mINFO [0m:      Sent reply
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>

================================================================================
🚀 NASA C-MAPSS Federated Learning Client
================================================================================
Client ID: client_4
Server: localhost:8686
Algorithm: FEDAVG
================================================================================

   🔧 LSTM config: hidden_dim=64, num_layers=2
   ✅ Converted to hidden_dims=[64, 64]
🖥️  Using device: cuda
✅ Found client data directory with all required files

📊 NASADataLoader initialized:
   Data path: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_4
   RUL mode: linear
   RUL power: 1
   Reduction: kpca

📂 Loading data files:
   Train data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_4/train_data.txt
   Train labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_4/train_labels.txt
   Test data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_4/test_data.txt
   Test labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_4/test_labels.txt

📊 Raw data loaded:
   Train: X=(4904, 24), y=(4904,)
   Test:  X=(1226, 24), y=(1226,)

🔧 Applying StandardScaler...

🔄 Creating LSTM sequences (length=10)...

✅ Data loading complete!
   Train: 4895 samples, 5 features
   Test:  1217 samples, 5 features

📊 Round 0 Test Metrics:
   Test Loss: 0.1618, RMSE: 0.4022, MAE: 0.3329, R²: -0.8959

📊 Round 0 Test Metrics:
   Test Loss: 0.1071, RMSE: 0.3272, MAE: 0.2668, R²: -0.2548

📊 Round 3 Training Metrics:
   Train Loss: 0.0028, RMSE: 0.0531, R²: 0.9662
   Val   Loss: 0.0831, RMSE: 0.2882, R²: -0.0379

📊 Round 3 Test Metrics:
   Test Loss: 0.0815, RMSE: 0.2854, MAE: 0.2351, R²: 0.0452

📊 Round 4 Training Metrics:
   Train Loss: 0.0083, RMSE: 0.0910, R²: 0.8991
   Val   Loss: 0.0781, RMSE: 0.2794, R²: 0.0867

📊 Round 8 Training Metrics:
   Train Loss: 0.0025, RMSE: 0.0505, R²: 0.9691
   Val   Loss: 0.0678, RMSE: 0.2604, R²: 0.1981

📊 Round 8 Test Metrics:
   Test Loss: 0.0760, RMSE: 0.2757, MAE: 0.2250, R²: 0.1090

📊 Round 12 Training Metrics:
   Train Loss: 0.0026, RMSE: 0.0508, R²: 0.9690
   Val   Loss: 0.0666, RMSE: 0.2580, R²: 0.1785

📊 Round 13 Training Metrics:
   Train Loss: 0.0049, RMSE: 0.0698, R²: 0.9410
   Val   Loss: 0.0628, RMSE: 0.2505, R²: 0.2553

📊 Round 13 Test Metrics:
   Test Loss: 0.0767, RMSE: 0.2770, MAE: 0.2236, R²: 0.1009

📊 Round 13 Test Metrics:
   Test Loss: 0.0764, RMSE: 0.2764, MAE: 0.2203, R²: 0.1044

📊 Round 15 Training Metrics:
   Train Loss: 0.0035, RMSE: 0.0592, R²: 0.9575
   Val   Loss: 0.0581, RMSE: 0.2410, R²: 0.3110

📊 Round 18 Training Metrics:
   Train Loss: 0.0026, RMSE: 0.0513, R²: 0.9682
   Val   Loss: 0.0595, RMSE: 0.2440, R²: 0.2885

📊 Round 20 Training Metrics:
   Train Loss: 0.0011, RMSE: 0.0332, R²: 0.9867
   Val   Loss: 0.0544, RMSE: 0.2332, R²: 0.3409

📊 Round 21 Training Metrics:
   Train Loss: 0.0018, RMSE: 0.0426, R²: 0.9779
   Val   Loss: 0.0536, RMSE: 0.2316, R²: 0.3776

📊 Round 23 Training Metrics:
   Train Loss: 0.0017, RMSE: 0.0411, R²: 0.9796
   Val   Loss: 0.0532, RMSE: 0.2307, R²: 0.3494

❌ Client client_4 error: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 942, in <module>
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>
