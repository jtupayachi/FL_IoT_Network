[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_numpy_client() is deprecated. 
	Instead, use `flwr.client.start_client()` by ensuring you first call the `.to_client()` method as shown below: 
	flwr.client.start_client(
		server_address='<IP>:<PORT>',
		client=FlowerClient().to_client(), # <-- where FlowerClient is of type flwr.client.NumPyClient object
	)
	Using `start_numpy_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_client() is deprecated.
	Instead, use the `flower-supernode` CLI command to start a SuperNode as shown below:

		$ flower-supernode --insecure --superlink='<IP>:<PORT>'

	To view all available options, run:

		$ flower-supernode --help

	Using `start_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 2cc84653-5458-4391-b88f-fe99d1731478
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message aea22c79-ad32-42f3-8c81-dd479f3c11c0
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 34a77572-ccec-45a7-9f13-85b81255f1d0
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 705aa506-a715-4faa-a1da-f0f2688d4ae4
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 58b3fff6-0ba2-4edd-a5b5-6338ef90c1da
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 5be9e903-fd8c-467b-bdfc-66893d5bd05f
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 3864000f-c9b8-4a31-bdd8-fe84120c6b7f
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 0bd1ae7a-f840-4666-8d8f-843be408feef
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 5133f3ce-e29a-4a01-9502-1dfa2785755f
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 919da48c-805e-4e2a-9c8d-31f0b22c7eaf
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message d7204687-3f32-4440-a5e7-886bb71e10ee
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message fac3c071-a3d1-4744-b29a-12e22b5974b4
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 3285d1d7-6aac-4962-b155-3f81e668b165
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message d4a093c8-e3fd-4aa6-b525-4a3cac9ca50d
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message b64d8a10-6d89-43f1-9d21-93a1f7d5614f
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message b3705b7f-24cb-4945-97eb-9bbb808cfe63
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 937156e1-da8c-4d8f-b1f3-75d8f9fffd6a
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 5a88744a-213d-4957-bf4d-43e2520bf2f0
[92mINFO [0m:      Sent reply
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>

================================================================================
🚀 NASA C-MAPSS Federated Learning Client
================================================================================
Client ID: client_7
Server: localhost:8686
Algorithm: FEDAVG
================================================================================

   🔧 LSTM config: hidden_dim=64, num_layers=2
   ✅ Converted to hidden_dims=[64, 64]
🖥️  Using device: cuda
✅ Found client data directory with all required files

📊 NASADataLoader initialized:
   Data path: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_7
   RUL mode: linear
   RUL power: 1
   Reduction: kpca

📂 Loading data files:
   Train data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_7/train_data.txt
   Train labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_7/train_labels.txt
   Test data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_7/test_data.txt
   Test labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_7/test_labels.txt

📊 Raw data loaded:
   Train: X=(4652, 24), y=(4652,)
   Test:  X=(1164, 24), y=(1164,)

🔧 Applying StandardScaler...

🔄 Creating LSTM sequences (length=10)...

✅ Data loading complete!
   Train: 4643 samples, 5 features
   Test:  1155 samples, 5 features

📊 Round 3 Training Metrics:
   Train Loss: 0.0041, RMSE: 0.0639, R²: 0.9511
   Val   Loss: 0.0741, RMSE: 0.2722, R²: 0.0910

📊 Round 5 Training Metrics:
   Train Loss: 0.0041, RMSE: 0.0644, R²: 0.9506
   Val   Loss: 0.0685, RMSE: 0.2617, R²: 0.1407

📊 Round 8 Training Metrics:
   Train Loss: 0.0023, RMSE: 0.0474, R²: 0.9726
   Val   Loss: 0.0600, RMSE: 0.2451, R²: 0.2997

📊 Round 8 Test Metrics:
   Test Loss: 0.0687, RMSE: 0.2622, MAE: 0.2125, R²: 0.1404

📊 Round 9 Training Metrics:
   Train Loss: 0.0043, RMSE: 0.0658, R²: 0.9482
   Val   Loss: 0.0615, RMSE: 0.2479, R²: 0.2373

📊 Round 9 Test Metrics:
   Test Loss: 0.0691, RMSE: 0.2629, MAE: 0.2132, R²: 0.1357

📊 Round 10 Training Metrics:
   Train Loss: 0.0031, RMSE: 0.0559, R²: 0.9626
   Val   Loss: 0.0549, RMSE: 0.2344, R²: 0.3152

📊 Round 11 Training Metrics:
   Train Loss: 0.0017, RMSE: 0.0411, R²: 0.9797
   Val   Loss: 0.0513, RMSE: 0.2266, R²: 0.3702

📊 Round 12 Training Metrics:
   Train Loss: 0.0030, RMSE: 0.0545, R²: 0.9647
   Val   Loss: 0.0521, RMSE: 0.2283, R²: 0.3357

📊 Round 14 Training Metrics:
   Train Loss: 0.0034, RMSE: 0.0583, R²: 0.9588
   Val   Loss: 0.0540, RMSE: 0.2324, R²: 0.3698

📊 Round 14 Test Metrics:
   Test Loss: 0.0647, RMSE: 0.2543, MAE: 0.2062, R²: 0.1912

📊 Round 14 Test Metrics:
   Test Loss: 0.0791, RMSE: 0.2813, MAE: 0.2314, R²: 0.0107

📊 Round 18 Training Metrics:
   Train Loss: 0.0037, RMSE: 0.0612, R²: 0.9550
   Val   Loss: 0.0538, RMSE: 0.2319, R²: 0.3461

📊 Round 19 Training Metrics:
   Train Loss: 0.0012, RMSE: 0.0341, R²: 0.9860
   Val   Loss: 0.0454, RMSE: 0.2132, R²: 0.4557

📊 Round 22 Training Metrics:
   Train Loss: 0.0017, RMSE: 0.0408, R²: 0.9797
   Val   Loss: 0.0535, RMSE: 0.2313, R²: 0.3855

📊 Round 22 Test Metrics:
   Test Loss: 0.0582, RMSE: 0.2413, MAE: 0.1944, R²: 0.2721

📊 Round 23 Training Metrics:
   Train Loss: 0.0011, RMSE: 0.0339, R²: 0.9862
   Val   Loss: 0.0454, RMSE: 0.2131, R²: 0.4436

📊 Round 23 Test Metrics:
   Test Loss: 0.0632, RMSE: 0.2515, MAE: 0.2030, R²: 0.2093

❌ Client client_7 error: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 942, in <module>
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>
