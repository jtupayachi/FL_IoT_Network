[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_numpy_client() is deprecated. 
	Instead, use `flwr.client.start_client()` by ensuring you first call the `.to_client()` method as shown below: 
	flwr.client.start_client(
		server_address='<IP>:<PORT>',
		client=FlowerClient().to_client(), # <-- where FlowerClient is of type flwr.client.NumPyClient object
	)
	Using `start_numpy_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_client() is deprecated.
	Instead, use the `flower-supernode` CLI command to start a SuperNode as shown below:

		$ flower-supernode --insecure --superlink='<IP>:<PORT>'

	To view all available options, run:

		$ flower-supernode --help

	Using `start_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 8acd7b33-6480-4b0d-af67-e25c3b82bb6d
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message e11ecea2-03f5-45ff-a21e-0e5928595cc1
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 3357ab7b-7c2e-441f-b6dd-5defbfac6d0b
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 9d13a415-d2b2-42c7-97dd-f8ee54e479b1
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 3b9fcbb0-5a89-43f2-8056-e6ee398d31b8
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 47851168-1f69-4604-a5c5-c4bbcc298a10
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 4d1090a5-50c2-48ac-8064-22fa1fad379d
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 4fda6bee-a5a8-403f-bfe3-37deff13a67e
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 2bc14df5-8c7a-4c98-ac51-4d4f0e3353be
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 87b0787b-9a14-4c78-82c5-03dae6fbb9c3
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 79cf48d7-dc0d-4446-8c64-95281f0e1109
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: train message ecf6f89c-26bc-4c60-9efa-8815ffdeae24
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message e2fa1fef-c4f2-4c74-897e-a2041002f96b
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 7a82d0ad-be78-4107-b157-5c40fbe88ab3
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 6b15cbd6-366e-4bac-95ce-df7ab4c14834
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 4bd4bb48-6d1a-4117-ada4-e13770059df4
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 474bfc97-7600-48bd-97e8-09ee63a9cbbb
[92mINFO [0m:      Sent reply
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message ff280083-a3b4-4b6b-84aa-27f06fa9a81e
[92mINFO [0m:      Sent reply
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>

================================================================================
🚀 NASA C-MAPSS Federated Learning Client
================================================================================
Client ID: client_9
Server: localhost:8686
Algorithm: FEDAVG
================================================================================

   🔧 LSTM config: hidden_dim=64, num_layers=2
   ✅ Converted to hidden_dims=[64, 64]
🖥️  Using device: cuda
✅ Found client data directory with all required files

📊 NASADataLoader initialized:
   Data path: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_9
   RUL mode: linear
   RUL power: 1
   Reduction: kpca

📂 Loading data files:
   Train data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_9/train_data.txt
   Train labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_9/train_labels.txt
   Test data: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_9/test_data.txt
   Test labels: /mnt/ceph_drive/FL_IoT_Network/scale/data/nasa_cmaps/pre_split_data/25_clients/alpha_0.005/client_9/test_labels.txt

📊 Raw data loaded:
   Train: X=(6456, 24), y=(6456,)
   Test:  X=(1614, 24), y=(1614,)

🔧 Applying StandardScaler...

🔄 Creating LSTM sequences (length=10)...

✅ Data loading complete!
   Train: 6447 samples, 5 features
   Test:  1605 samples, 5 features

📊 Round 3 Training Metrics:
   Train Loss: 0.0080, RMSE: 0.0896, R²: 0.9036
   Val   Loss: 0.0792, RMSE: 0.2815, R²: 0.0195

📊 Round 3 Test Metrics:
   Test Loss: 0.1146, RMSE: 0.3385, MAE: 0.2785, R²: -0.3711

📊 Round 4 Training Metrics:
   Train Loss: 0.0067, RMSE: 0.0820, R²: 0.9184
   Val   Loss: 0.0786, RMSE: 0.2803, R²: 0.0722

📊 Round 4 Test Metrics:
   Test Loss: 0.1172, RMSE: 0.3423, MAE: 0.2781, R²: -0.4017

📊 Round 6 Training Metrics:
   Train Loss: 0.0053, RMSE: 0.0728, R²: 0.9355
   Val   Loss: 0.0720, RMSE: 0.2683, R²: 0.1571

📊 Round 10 Training Metrics:
   Train Loss: 0.0021, RMSE: 0.0460, R²: 0.9747
   Val   Loss: 0.0655, RMSE: 0.2559, R²: 0.1784

📊 Round 11 Training Metrics:
   Train Loss: 0.0025, RMSE: 0.0495, R²: 0.9704
   Val   Loss: 0.0606, RMSE: 0.2461, R²: 0.2691

📊 Round 11 Test Metrics:
   Test Loss: 0.1083, RMSE: 0.3291, MAE: 0.2652, R²: -0.2957

📊 Round 11 Test Metrics:
   Test Loss: 0.1169, RMSE: 0.3420, MAE: 0.2749, R²: -0.3990

📊 Round 13 Training Metrics:
   Train Loss: 0.0024, RMSE: 0.0492, R²: 0.9709
   Val   Loss: 0.0609, RMSE: 0.2467, R²: 0.2442

📊 Round 13 Test Metrics:
   Test Loss: 0.1046, RMSE: 0.3234, MAE: 0.2611, R²: -0.2509

📊 Round 16 Training Metrics:
   Train Loss: 0.0020, RMSE: 0.0450, R²: 0.9755
   Val   Loss: 0.0646, RMSE: 0.2542, R²: 0.2358

📊 Round 16 Test Metrics:
   Test Loss: 0.0858, RMSE: 0.2929, MAE: 0.2351, R²: -0.0261

📊 Round 16 Test Metrics:
   Test Loss: 0.1104, RMSE: 0.3323, MAE: 0.2632, R²: -0.3213

📊 Round 16 Test Metrics:
   Test Loss: 0.1148, RMSE: 0.3388, MAE: 0.2694, R²: -0.3734

📊 Round 16 Test Metrics:
   Test Loss: 0.1089, RMSE: 0.3300, MAE: 0.2626, R²: -0.3027

📊 Round 16 Test Metrics:
   Test Loss: 0.1130, RMSE: 0.3362, MAE: 0.2657, R²: -0.3524

📊 Round 16 Test Metrics:
   Test Loss: 0.1122, RMSE: 0.3350, MAE: 0.2661, R²: -0.3425

❌ Client client_9 error: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>
Traceback (most recent call last):
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 942, in <module>
  File "/mnt/ceph_drive/FL_IoT_Network/scale/client.py", line 922, in main
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 624, in start_numpy_client
    start_client(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 183, in start_client
    start_client_internal(
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/app.py", line 394, in start_client_internal
    message = receive()
              ^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/flwr/compat/client/grpc_client/connection.py", line 142, in receive
    proto = next(server_message_iterator)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 538, in __next__
    return self._next()
           ^^^^^^^^^^^^
  File "/mnt/ceph_drive/FL_IoT_Network/flwr-nasa/lib/python3.11/site-packages/grpc/_channel.py", line 962, in _next
    raise self
grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "Socket closed"
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B::1%5D:8686 {grpc_message:"Socket closed", grpc_status:14}"
>
